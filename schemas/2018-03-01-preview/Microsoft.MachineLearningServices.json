{
  "id": "https://schema.management.azure.com/schemas/2018-03-01-preview/Microsoft.MachineLearningServices.json#",
  "title": "Microsoft.MachineLearningServices",
  "description": "Microsoft MachineLearningServices Resource Types",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "resourceDefinitions": {
    "workspaces_computes": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2018-03-01-preview"
          ]
        },
        "name": {
          "type": "string",
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.MachineLearningServices/workspaces/computes"
          ]
        },
        "identity": {
          "oneOf": [
            {
              "$ref": "#/definitions/Identity"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The identity of the resource."
        },
        "location": {
          "type": "string",
          "description": "Specifies the location of the resource."
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/Compute"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Compute properties"
        },
        "tags": {
          "oneOf": [
            {
              "$ref": "#/definitions/ResourceTags"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Contains resource tags defined as key/value pairs."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.MachineLearningServices/workspaces/computes"
    },
    "workspaces": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2018-03-01-preview"
          ]
        },
        "name": {
          "type": "string",
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.MachineLearningServices/workspaces"
          ]
        },
        "identity": {
          "oneOf": [
            {
              "$ref": "#/definitions/Identity"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The identity of the resource."
        },
        "location": {
          "type": "string",
          "description": "Specifies the location of the resource."
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/WorkspaceProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The properties of the machine learning workspace."
        },
        "tags": {
          "oneOf": [
            {
              "$ref": "#/definitions/ResourceTags"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Contains resource tags defined as key/value pairs."
        },
        "resources": {
          "type": "array",
          "items": {
            "oneOf": [
              {
                "$ref": "#/definitions/workspaces_computes_childResource"
              }
            ]
          }
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.MachineLearningServices/workspaces"
    }
  },
  "definitions": {
    "AKS": {
      "type": "object",
      "properties": {
        "computeType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "AKS"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The type of compute"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/AKSProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "AKS properties"
        }
      },
      "required": [
        "computeType"
      ]
    },
    "AKSProperties": {
      "type": "object",
      "properties": {
        "agentCount": {
          "oneOf": [
            {
              "type": "integer",
              "minimum": 1
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Number of agents"
        },
        "agentVMSize": {
          "type": "string",
          "description": "Agent virtual machine size"
        },
        "clusterFqdn": {
          "type": "string",
          "description": "Cluster full qualified domain name"
        },
        "sslConfiguration": {
          "oneOf": [
            {
              "$ref": "#/definitions/SslConfiguration"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "SSL configuration"
        },
        "systemServices": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/SystemService"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "System services"
        }
      }
    },
    "BatchAI": {
      "type": "object",
      "properties": {
        "computeType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "BatchAI"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The type of compute"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/BatchAIProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "BatchAI properties"
        }
      },
      "required": [
        "computeType"
      ]
    },
    "BatchAIProperties": {
      "type": "object",
      "properties": {
        "scaleSettings": {
          "oneOf": [
            {
              "$ref": "#/definitions/ScaleSettings"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Scale settings for BatchAI"
        },
        "vmPriority": {
          "type": "string",
          "description": "Virtual Machine priority"
        },
        "vmSize": {
          "type": "string",
          "description": "Virtual Machine Size"
        }
      }
    },
    "Compute": {
      "allOf": [
        {
          "type": "object",
          "properties": {
            "computeLocation": {
              "type": "string",
              "description": "Location for the underlying compute"
            },
            "description": {
              "type": "string",
              "description": "The description of the Machine Learning compute."
            },
            "resourceId": {
              "type": "string",
              "description": "ARM resource id of the compute"
            },
            "computeType": {
              "type": "string",
              "enum": [
                "AKS",
                "BatchAI",
                "DataFactory",
                "HDInsight",
                "VirtualMachine"
              ]
            }
          },
          "required": [
            "computeType"
          ],
          "additionalProperties": false
        },
        {
          "oneOf": [
            {
              "allOf": [
                {
                  "$ref": "#/definitions/AKS"
                },
                {
                  "type": "object",
                  "properties": {
                    "computeType": {
                      "const": "AKS"
                    }
                  },
                  "required": [
                    "computeType"
                  ]
                }
              ]
            },
            {
              "allOf": [
                {
                  "$ref": "#/definitions/BatchAI"
                },
                {
                  "type": "object",
                  "properties": {
                    "computeType": {
                      "const": "BatchAI"
                    }
                  },
                  "required": [
                    "computeType"
                  ]
                }
              ]
            },
            {
              "allOf": [
                {
                  "$ref": "#/definitions/DataFactory"
                },
                {
                  "type": "object",
                  "properties": {
                    "computeType": {
                      "const": "DataFactory"
                    }
                  },
                  "required": [
                    "computeType"
                  ]
                }
              ]
            },
            {
              "allOf": [
                {
                  "$ref": "#/definitions/HDInsight"
                },
                {
                  "type": "object",
                  "properties": {
                    "computeType": {
                      "const": "HDInsight"
                    }
                  },
                  "required": [
                    "computeType"
                  ]
                }
              ]
            },
            {
              "allOf": [
                {
                  "$ref": "#/definitions/VirtualMachine"
                },
                {
                  "type": "object",
                  "properties": {
                    "computeType": {
                      "const": "VirtualMachine"
                    }
                  },
                  "required": [
                    "computeType"
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "DataFactory": {
      "type": "object",
      "properties": {
        "computeType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "DataFactory"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The type of compute"
        }
      },
      "required": [
        "computeType"
      ]
    },
    "HDInsight": {
      "type": "object",
      "properties": {
        "computeType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "HDInsight"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The type of compute"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/HDInsightProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        }
      },
      "required": [
        "computeType"
      ]
    },
    "HDInsightProperties": {
      "type": "object",
      "properties": {
        "address": {
          "type": "string",
          "description": "Public IP address of the master node of the cluster."
        },
        "administratorAccount": {
          "oneOf": [
            {
              "$ref": "#/definitions/VirtualMachineSshCredentials"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Admin credentials for master node of the cluster"
        },
        "sshPort": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Port open for ssh connections on the master node of the cluster."
        }
      }
    },
    "Identity": {
      "type": "object",
      "properties": {
        "type": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "SystemAssigned"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The identity type."
        }
      }
    },
    "ResourceTags": {
      "type": "object",
      "properties": {},
      "additionalProperties": {
        "type": "string"
      }
    },
    "ScaleSettings": {
      "type": "object",
      "properties": {
        "autoScaleEnabled": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Enable or disable auto scale"
        },
        "maxNodeCount": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Max number of nodes to use"
        },
        "minNodeCount": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Min number of nodes to use"
        }
      }
    },
    "SslConfiguration": {
      "type": "object",
      "properties": {
        "cert": {
          "type": "string",
          "description": "Cert data"
        },
        "cname": {
          "type": "string",
          "description": "CNAME of the cert"
        },
        "key": {
          "type": "string",
          "description": "Key data"
        },
        "status": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Disabled",
                "Enabled"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Enable or disable SSL for scoring"
        }
      }
    },
    "SystemService": {
      "type": "object",
      "properties": {}
    },
    "VirtualMachine": {
      "type": "object",
      "properties": {
        "computeType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "VirtualMachine"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The type of compute"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/VirtualMachineProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        }
      },
      "required": [
        "computeType"
      ]
    },
    "VirtualMachineProperties": {
      "type": "object",
      "properties": {
        "address": {
          "type": "string",
          "description": "Public IP address of the virtual machine."
        },
        "administratorAccount": {
          "oneOf": [
            {
              "$ref": "#/definitions/VirtualMachineSshCredentials"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Admin credentials for virtual machine"
        },
        "sshPort": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Port open for ssh connections."
        },
        "virtualMachineSize": {
          "type": "string",
          "description": "Virtual Machine size"
        }
      }
    },
    "VirtualMachineSshCredentials": {
      "type": "object",
      "properties": {
        "password": {
          "type": "string",
          "description": "Password of admin account"
        },
        "privateKeyData": {
          "type": "string",
          "description": "Private key data"
        },
        "publicKeyData": {
          "type": "string",
          "description": "Public key data"
        },
        "username": {
          "type": "string",
          "description": "Username of admin account"
        }
      }
    },
    "WorkspaceProperties": {
      "type": "object",
      "properties": {
        "applicationInsights": {
          "type": "string",
          "description": "ARM id of the application insights associated with this workspace. This cannot be changed once the workspace has been created"
        },
        "batchaiWorkspace": {
          "type": "string",
          "description": "ARM id of the Batch AI workspace associated with this workspace. This cannot be changed once the workspace has been created"
        },
        "containerRegistry": {
          "type": "string",
          "description": "ARM id of the container registry associated with this workspace. This cannot be changed once the workspace has been created"
        },
        "description": {
          "type": "string",
          "description": "The description of this workspace."
        },
        "discoveryUrl": {
          "type": "string",
          "description": "Url for the discovery service to identify regional endpoints for machine learning experimentation services"
        },
        "friendlyName": {
          "type": "string",
          "description": "The friendly name for this workspace. This name in mutable"
        },
        "keyVault": {
          "type": "string",
          "description": "ARM id of the key vault associated with this workspace. This cannot be changed once the workspace has been created"
        },
        "storageAccount": {
          "type": "string",
          "description": "ARM id of the storage account associated with this workspace. This cannot be changed once the workspace has been created"
        }
      }
    },
    "workspaces_computes_childResource": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2018-03-01-preview"
          ]
        },
        "name": {
          "type": "string",
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "computes"
          ]
        },
        "identity": {
          "oneOf": [
            {
              "$ref": "#/definitions/Identity"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The identity of the resource."
        },
        "location": {
          "type": "string",
          "description": "Specifies the location of the resource."
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/Compute"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Compute properties"
        },
        "tags": {
          "oneOf": [
            {
              "$ref": "#/definitions/ResourceTags"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Contains resource tags defined as key/value pairs."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.MachineLearningServices/workspaces/computes"
    }
  }
}