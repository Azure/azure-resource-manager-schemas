{
  "id": "https://schema.management.azure.com/schemas/2018-07-01-preview/Microsoft.ServiceFabricMesh.json#",
  "title": "Microsoft.ServiceFabricMesh",
  "description": "Microsoft ServiceFabricMesh Resource Types",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "resourceDefinitions": {
    "applications": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2018-07-01-preview"
          ]
        },
        "name": {
          "type": "string",
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.ServiceFabricMesh/applications"
          ]
        },
        "location": {
          "type": "string",
          "description": "The geo-location where the resource lives"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/ApplicationResourceProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "This type describes properties of an application resource."
        },
        "tags": {
          "oneOf": [
            {
              "$ref": "#/definitions/TrackedResourceTags"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Resource tags."
        },
        "resources": {
          "type": "array",
          "items": {
            "oneOf": [
              {
                "$ref": "#/definitions/applications_services_childResource"
              }
            ]
          }
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.ServiceFabricMesh/applications"
    },
    "networks": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2018-07-01-preview"
          ]
        },
        "name": {
          "type": "string",
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.ServiceFabricMesh/networks"
          ]
        },
        "location": {
          "type": "string",
          "description": "The geo-location where the resource lives"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/NetworkResourceProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describes properties of a network resource."
        },
        "tags": {
          "oneOf": [
            {
              "$ref": "#/definitions/TrackedResourceTags"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Resource tags."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.ServiceFabricMesh/networks"
    },
    "volumes": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2018-07-01-preview"
          ]
        },
        "name": {
          "type": "string",
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.ServiceFabricMesh/volumes"
          ]
        },
        "location": {
          "type": "string",
          "description": "The geo-location where the resource lives"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/VolumeResourceProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describes properties of a volume resource."
        },
        "tags": {
          "oneOf": [
            {
              "$ref": "#/definitions/TrackedResourceTags"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Resource tags."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.ServiceFabricMesh/volumes"
    }
  },
  "unknown_resourceDefinitions": {
    "applications_services": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2018-07-01-preview"
          ]
        },
        "name": {
          "type": "string",
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.ServiceFabricMesh/applications/services"
          ]
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type"
      ],
      "description": "Microsoft.ServiceFabricMesh/applications/services"
    }
  },
  "definitions": {
    "ApplicationResourceProperties": {
      "type": "object",
      "properties": {
        "debugParams": {
          "type": "string",
          "description": "Internal use."
        },
        "description": {
          "type": "string",
          "description": "User readable description of the application."
        },
        "diagnostics": {
          "oneOf": [
            {
              "$ref": "#/definitions/DiagnosticsDescription"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describes the diagnostics definition and usage for an application resource."
        },
        "services": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ServiceResourceDescription"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "describes the services in the application."
        }
      }
    },
    "AzureInternalMonitoringPipelineSinkDescription": {
      "type": "object",
      "properties": {
        "accountName": {
          "type": "string",
          "description": "Azure Internal monitoring pipeline account."
        },
        "autoKeyConfigUrl": {
          "type": "string",
          "description": "Azure Internal monitoring pipeline autokey associated with the certificate."
        },
        "fluentdConfigUrl": {
          "oneOf": [
            {},
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Azure Internal monitoring agent fluentd configuration."
        },
        "kind": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "AzureInternalMonitoringPipeline"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The kind of DiagnosticsSink."
        },
        "maConfigUrl": {
          "type": "string",
          "description": "Azure Internal monitoring agent configuration."
        },
        "namespace": {
          "type": "string",
          "description": "Azure Internal monitoring pipeline account namespace."
        }
      },
      "required": [
        "kind"
      ]
    },
    "ContainerCodePackageProperties": {
      "type": "object",
      "properties": {
        "commands": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Command array to execute within the container in exec form."
        },
        "diagnostics": {
          "oneOf": [
            {
              "$ref": "#/definitions/DiagnosticsRef"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Reference to sinks in DiagnosticsDescription."
        },
        "endpoints": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/EndpointProperties"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The endpoints exposed by this container."
        },
        "entrypoint": {
          "type": "string",
          "description": "Override for the default entry point in the container."
        },
        "environmentVariables": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/EnvironmentVariable"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The environment variables to set in this container"
        },
        "image": {
          "type": "string",
          "description": "The Container image to use."
        },
        "imageRegistryCredential": {
          "oneOf": [
            {
              "$ref": "#/definitions/ImageRegistryCredential"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Image registry credential."
        },
        "labels": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ContainerLabel"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The labels to set in this container."
        },
        "name": {
          "type": "string",
          "description": "The name of the code package."
        },
        "resources": {
          "oneOf": [
            {
              "$ref": "#/definitions/ResourceRequirements"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "This type describes the resource requirements for a container or a service."
        },
        "settings": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Setting"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The settings to set in this container. The setting file path can be fetched from environment variable \"Fabric_SettingPath\". The path for Windows container is \"C:\\\\secrets\". The path for Linux container is \"/var/secrets\"."
        },
        "volumeRefs": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ContainerVolume"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The volumes to be attached to the container."
        }
      },
      "required": [
        "image",
        "name",
        "resources"
      ]
    },
    "ContainerLabel": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the container label."
        },
        "value": {
          "type": "string",
          "description": "The value of the container label."
        }
      },
      "required": [
        "name",
        "value"
      ]
    },
    "ContainerVolume": {
      "type": "object",
      "properties": {
        "destinationPath": {
          "type": "string",
          "description": "The path within the container at which the volume should be mounted. Only valid path characters are allowed."
        },
        "name": {
          "type": "string",
          "description": "Name of the volume."
        },
        "readOnly": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The flag indicating whether the volume is read only. Default is 'false'."
        }
      },
      "required": [
        "destinationPath",
        "name"
      ]
    },
    "DiagnosticsDescription": {
      "type": "object",
      "properties": {
        "defaultSinkRefs": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The sinks to be used if diagnostics is enabled. Sink choices can be overridden at the service and code package level."
        },
        "enabled": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Status of whether or not sinks are enabled."
        },
        "sinks": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/DiagnosticsSinkProperties"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "List of supported sinks that can be referenced."
        }
      }
    },
    "DiagnosticsRef": {
      "type": "object",
      "properties": {
        "enabled": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Status of whether or not sinks are enabled."
        },
        "sinkRefs": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "List of sinks to be used if enabled. References the list of sinks in DiagnosticsDescription."
        }
      }
    },
    "DiagnosticsSinkProperties": {
      "allOf": [
        {
          "type": "object",
          "properties": {
            "description": {
              "type": "string",
              "description": "A description of the sink."
            },
            "name": {
              "type": "string",
              "description": "Name of the sink. This value is referenced by DiagnosticsReferenceDescription"
            },
            "kind": {
              "type": "string",
              "enum": [
                "AzureInternalMonitoringPipeline"
              ]
            }
          },
          "required": [
            "kind"
          ],
          "additionalProperties": false
        },
        {
          "oneOf": [
            {
              "allOf": [
                {
                  "$ref": "#/definitions/AzureInternalMonitoringPipelineSinkDescription"
                },
                {
                  "type": "object",
                  "properties": {
                    "kind": {
                      "const": "AzureInternalMonitoringPipeline"
                    }
                  },
                  "required": [
                    "kind"
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "EndpointProperties": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the endpoint."
        },
        "port": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Port used by the container."
        }
      },
      "required": [
        "name"
      ]
    },
    "EnvironmentVariable": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the environment variable."
        },
        "value": {
          "type": "string",
          "description": "The value of the environment variable."
        }
      }
    },
    "ImageRegistryCredential": {
      "type": "object",
      "properties": {
        "password": {
          "type": "string",
          "description": "The password for the private registry."
        },
        "server": {
          "type": "string",
          "description": "Docker image registry server, without protocol such as `http` and `https`."
        },
        "username": {
          "type": "string",
          "description": "The username for the private registry."
        }
      },
      "required": [
        "server",
        "username"
      ]
    },
    "IngressConfig": {
      "type": "object",
      "properties": {
        "layer4": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Layer4IngressConfig"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Configuration for layer4 public connectivity for this network."
        },
        "qosLevel": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Bronze"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The QoS tier for ingress."
        }
      }
    },
    "Layer4IngressConfig": {
      "type": "object",
      "properties": {
        "applicationName": {
          "type": "string",
          "description": "The application name which contains the service to be exposed."
        },
        "endpointName": {
          "type": "string",
          "description": "The service endpoint that needs to be exposed."
        },
        "name": {
          "type": "string",
          "description": "Layer4 ingress config name."
        },
        "publicPort": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Specifies the public port at which the service endpoint below needs to be exposed."
        },
        "serviceName": {
          "type": "string",
          "description": "The service whose endpoint needs to be exposed at the public port."
        }
      }
    },
    "NetworkRef": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "Name of the network."
        }
      }
    },
    "NetworkResourceProperties": {
      "type": "object",
      "properties": {
        "addressPrefix": {
          "type": "string",
          "description": "the address prefix for this network."
        },
        "description": {
          "type": "string",
          "description": "User readable description of the network."
        },
        "ingressConfig": {
          "oneOf": [
            {
              "$ref": "#/definitions/IngressConfig"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Configuration for public connectivity for this network."
        }
      },
      "required": [
        "addressPrefix"
      ]
    },
    "ResourceLimits": {
      "type": "object",
      "properties": {
        "cpu": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "CPU limits in cores. At present, only full cores are supported."
        },
        "memoryInGB": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The memory limit in GB."
        }
      }
    },
    "ResourceRequests": {
      "type": "object",
      "properties": {
        "cpu": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Requested number of CPU cores. At present, only full cores are supported."
        },
        "memoryInGB": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The memory request in GB for this container."
        }
      },
      "required": [
        "cpu",
        "memoryInGB"
      ]
    },
    "ResourceRequirements": {
      "type": "object",
      "properties": {
        "limits": {
          "oneOf": [
            {
              "$ref": "#/definitions/ResourceLimits"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describes the maximum limits on the resources for a given container."
        },
        "requests": {
          "oneOf": [
            {
              "$ref": "#/definitions/ResourceRequests"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describes the requested resources for a given container."
        }
      },
      "required": [
        "requests"
      ]
    },
    "ServiceResourceDescription": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the resource"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/ServiceResourceProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "This type describes properties of a service resource."
        }
      },
      "required": [
        "properties"
      ]
    },
    "ServiceResourceProperties": {
      "type": "object",
      "properties": {
        "codePackages": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ContainerCodePackageProperties"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describes the set of code packages that forms the service. A code package describes the container and the properties for running it. All the code packages are started together on the same host and share the same context (network, process etc.)."
        },
        "description": {
          "type": "string",
          "description": "User readable description of the service."
        },
        "diagnostics": {
          "oneOf": [
            {
              "$ref": "#/definitions/DiagnosticsRef"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Reference to sinks in DiagnosticsDescription."
        },
        "healthState": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Invalid",
                "Ok",
                "Warning",
                "Error",
                "Unknown"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The health state of a resource such as Application, Service, or Network."
        },
        "networkRefs": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/NetworkRef"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The names of the private networks that this service needs to be part of."
        },
        "osType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Linux",
                "Windows"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The Operating system type required by the code in service."
        },
        "replicaCount": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The number of replicas of the service to create. Defaults to 1 if not specified."
        }
      },
      "required": [
        "codePackages",
        "osType"
      ]
    },
    "Setting": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the setting."
        },
        "value": {
          "type": "string",
          "description": "The value of the setting."
        }
      }
    },
    "TrackedResourceTags": {
      "type": "object",
      "properties": {},
      "additionalProperties": {
        "type": "string"
      }
    },
    "VolumeProviderParametersAzureFile": {
      "type": "object",
      "properties": {
        "accountKey": {
          "type": "string",
          "description": "Access key of the Azure storage account for the File Share."
        },
        "accountName": {
          "type": "string",
          "description": "Name of the Azure storage account for the File Share."
        },
        "shareName": {
          "type": "string",
          "description": "Name of the Azure Files file share that provides storage for the volume."
        }
      },
      "required": [
        "accountName",
        "shareName"
      ]
    },
    "VolumeResourceProperties": {
      "type": "object",
      "properties": {
        "azureFileParameters": {
          "oneOf": [
            {
              "$ref": "#/definitions/VolumeProviderParametersAzureFile"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "This type describes a volume provided by an Azure Files file share."
        },
        "description": {
          "type": "string",
          "description": "User readable description of the volume."
        },
        "provider": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "SFAzureFile"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Provider of the volume."
        }
      },
      "required": [
        "provider"
      ]
    },
    "applications_services_childResource": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2018-07-01-preview"
          ]
        },
        "name": {
          "type": "string",
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "services"
          ]
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type"
      ],
      "description": "Microsoft.ServiceFabricMesh/applications/services"
    }
  }
}