{
  "id": "https://schema.management.azure.com/schemas/2020-01-01/Microsoft.SecurityInsights.json#",
  "title": "Microsoft.SecurityInsights",
  "description": "Microsoft SecurityInsights Resource Types",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "unknown_resourceDefinitions": {
    "alertRuleTemplates": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "kind": {
              "oneOf": [
                {
                  "type": "string",
                  "enum": [
                    "Fusion"
                  ]
                },
                {
                  "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
                }
              ],
              "description": "The alert rule kind"
            }
          },
          "required": [
            "kind"
          ]
        },
        {
          "type": "object",
          "properties": {
            "kind": {
              "oneOf": [
                {
                  "type": "string",
                  "enum": [
                    "MicrosoftSecurityIncidentCreation"
                  ]
                },
                {
                  "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
                }
              ],
              "description": "The alert rule kind"
            }
          },
          "required": [
            "kind"
          ]
        },
        {
          "type": "object",
          "properties": {
            "kind": {
              "oneOf": [
                {
                  "type": "string",
                  "enum": [
                    "Scheduled"
                  ]
                },
                {
                  "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
                }
              ],
              "description": "The alert rule kind"
            }
          },
          "required": [
            "kind"
          ]
        }
      ],
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2020-01-01"
          ]
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.SecurityInsights/alertRuleTemplates"
          ]
        }
      },
      "required": [
        "apiVersion",
        "type"
      ],
      "description": "Microsoft.SecurityInsights/alertRuleTemplates"
    }
  },
  "definitions": {
    "AADDataConnector": {
      "type": "object",
      "properties": {
        "kind": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "AzureActiveDirectory"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The data connector kind"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/AADDataConnectorProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "AAD (Azure Active Directory) data connector properties."
        }
      },
      "required": [
        "kind"
      ]
    },
    "AADDataConnectorProperties": {
      "type": "object",
      "properties": {
        "dataTypes": {
          "oneOf": [
            {
              "$ref": "#/definitions/AlertsDataTypeOfDataConnector"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The available data types for the connector."
        },
        "tenantId": {
          "type": "string",
          "description": "The tenant id to connect to, and get the data from."
        }
      }
    },
    "AatpDataConnector": {
      "type": "object",
      "properties": {
        "kind": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "AzureAdvancedThreatProtection"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The data connector kind"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/AatpDataConnectorProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "AATP (Azure Advanced Threat Protection) data connector properties."
        }
      },
      "required": [
        "kind"
      ]
    },
    "AatpDataConnectorProperties": {
      "type": "object",
      "properties": {
        "dataTypes": {
          "oneOf": [
            {
              "$ref": "#/definitions/AlertsDataTypeOfDataConnector"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The available data types for the connector."
        },
        "tenantId": {
          "type": "string",
          "description": "The tenant id to connect to, and get the data from."
        }
      }
    },
    "ActionRequestPropertiesOrActionResponseProperties": {
      "type": "object",
      "properties": {
        "logicAppResourceId": {
          "type": "string",
          "description": "Logic App Resource Id, /subscriptions/{my-subscription}/resourceGroups/{my-resource-group}/providers/Microsoft.Logic/workflows/{my-workflow-id}."
        },
        "triggerUri": {
          "type": "string",
          "description": "Logic App Callback URL for this specific workflow."
        }
      },
      "required": [
        "logicAppResourceId",
        "triggerUri"
      ]
    },
    "AlertsDataTypeOfDataConnector": {
      "type": "object",
      "properties": {
        "alerts": {
          "oneOf": [
            {
              "$ref": "#/definitions/DataConnectorDataTypeCommon"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Alerts data type connection."
        }
      }
    },
    "ASCDataConnector": {
      "type": "object",
      "properties": {
        "kind": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "AzureSecurityCenter"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The data connector kind"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/ASCDataConnectorProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "ASC (Azure Security Center) data connector properties."
        }
      },
      "required": [
        "kind"
      ]
    },
    "ASCDataConnectorProperties": {
      "type": "object",
      "properties": {
        "dataTypes": {
          "oneOf": [
            {
              "$ref": "#/definitions/AlertsDataTypeOfDataConnector"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The available data types for the connector."
        },
        "subscriptionId": {
          "type": "string",
          "description": "The subscription id to connect to, and get the data from."
        }
      }
    },
    "AwsCloudTrailDataConnector": {
      "type": "object",
      "properties": {
        "kind": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "AmazonWebServicesCloudTrail"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The data connector kind"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/AwsCloudTrailDataConnectorProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Amazon Web Services CloudTrail data connector properties."
        }
      },
      "required": [
        "kind"
      ]
    },
    "AwsCloudTrailDataConnectorDataTypes": {
      "type": "object",
      "properties": {
        "logs": {
          "oneOf": [
            {
              "$ref": "#/definitions/AwsCloudTrailDataConnectorDataTypesLogs"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Logs data type."
        }
      }
    },
    "AwsCloudTrailDataConnectorDataTypesLogs": {
      "type": "object",
      "properties": {
        "state": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Enabled",
                "Disabled"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describe whether this data type connection is enabled or not."
        }
      }
    },
    "AwsCloudTrailDataConnectorProperties": {
      "type": "object",
      "properties": {
        "awsRoleArn": {
          "type": "string",
          "description": "The Aws Role Arn (with CloudTrailReadOnly policy) that is used to access the Aws account."
        },
        "dataTypes": {
          "oneOf": [
            {
              "$ref": "#/definitions/AwsCloudTrailDataConnectorDataTypes"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The available data types for the connector."
        }
      }
    },
    "BookmarkProperties": {
      "type": "object",
      "properties": {
        "created": {
          "type": "string",
          "description": "The time the bookmark was created"
        },
        "createdBy": {
          "oneOf": [
            {
              "$ref": "#/definitions/UserInfo"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describes a user that created the bookmark"
        },
        "displayName": {
          "type": "string",
          "description": "The display name of the bookmark"
        },
        "eventTime": {
          "type": "string",
          "description": "The bookmark event time"
        },
        "incidentInfo": {
          "oneOf": [
            {
              "$ref": "#/definitions/IncidentInfo"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describes an incident that relates to bookmark"
        },
        "labels": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "List of labels relevant to this bookmark"
        },
        "notes": {
          "type": "string",
          "description": "The notes of the bookmark"
        },
        "query": {
          "type": "string",
          "description": "The query of the bookmark."
        },
        "queryEndTime": {
          "type": "string",
          "description": "The end time for the query"
        },
        "queryResult": {
          "type": "string",
          "description": "The query result of the bookmark."
        },
        "queryStartTime": {
          "type": "string",
          "description": "The start time for the query"
        },
        "updated": {
          "type": "string",
          "description": "The last time the bookmark was updated"
        },
        "updatedBy": {
          "oneOf": [
            {
              "$ref": "#/definitions/UserInfo"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describes a user that updated the bookmark"
        }
      },
      "required": [
        "displayName",
        "query"
      ]
    },
    "DataConnectorDataTypeCommon": {
      "type": "object",
      "properties": {
        "state": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Enabled",
                "Disabled"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describe whether this data type connection is enabled or not."
        }
      }
    },
    "FusionAlertRule": {
      "type": "object",
      "properties": {
        "kind": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Fusion"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The alert rule kind"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/FusionAlertRuleProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Fusion alert rule properties"
        }
      },
      "required": [
        "kind"
      ]
    },
    "FusionAlertRuleProperties": {
      "type": "object",
      "properties": {
        "alertRuleTemplateName": {
          "type": "string",
          "description": "The Name of the alert rule template used to create this rule."
        },
        "enabled": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Determines whether this alert rule is enabled or disabled."
        }
      },
      "required": [
        "alertRuleTemplateName",
        "enabled"
      ]
    },
    "FusionAlertRuleTemplate": {
      "type": "object",
      "properties": {
        "kind": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Fusion"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The alert rule kind"
        }
      },
      "required": [
        "kind"
      ]
    },
    "IncidentCommentProperties": {
      "type": "object",
      "properties": {
        "message": {
          "type": "string",
          "description": "The comment message"
        }
      },
      "required": [
        "message"
      ]
    },
    "IncidentInfo": {
      "type": "object",
      "properties": {
        "incidentId": {
          "type": "string",
          "description": "Incident Id"
        },
        "relationName": {
          "type": "string",
          "description": "Relation Name"
        },
        "severity": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "High",
                "Medium",
                "Low",
                "Informational"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The severity of the incident"
        },
        "title": {
          "type": "string",
          "description": "The title of the incident"
        }
      }
    },
    "IncidentLabel": {
      "type": "object",
      "properties": {
        "labelName": {
          "type": "string",
          "description": "The name of the label"
        }
      },
      "required": [
        "labelName"
      ]
    },
    "IncidentOwnerInfo": {
      "type": "object",
      "properties": {
        "assignedTo": {
          "type": "string",
          "description": "The name of the user the incident is assigned to."
        },
        "email": {
          "type": "string",
          "description": "The email of the user the incident is assigned to."
        },
        "objectId": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$",
              "minLength": 36,
              "maxLength": 36
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The object id of the user the incident is assigned to."
        },
        "userPrincipalName": {
          "type": "string",
          "description": "The user principal name of the user the incident is assigned to."
        }
      }
    },
    "IncidentProperties": {
      "type": "object",
      "properties": {
        "classification": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Undetermined",
                "TruePositive",
                "BenignPositive",
                "FalsePositive"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The reason the incident was closed"
        },
        "classificationComment": {
          "type": "string",
          "description": "Describes the reason the incident was closed"
        },
        "classificationReason": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "SuspiciousActivity",
                "SuspiciousButExpected",
                "IncorrectAlertLogic",
                "InaccurateData"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The classification reason the incident was closed with"
        },
        "description": {
          "type": "string",
          "description": "The description of the incident"
        },
        "firstActivityTimeUtc": {
          "type": "string",
          "description": "The time of the first activity in the incident"
        },
        "labels": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/IncidentLabel"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "List of labels relevant to this incident"
        },
        "lastActivityTimeUtc": {
          "type": "string",
          "description": "The time of the last activity in the incident"
        },
        "owner": {
          "oneOf": [
            {
              "$ref": "#/definitions/IncidentOwnerInfo"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describes a user that the incident is assigned to"
        },
        "severity": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "High",
                "Medium",
                "Low",
                "Informational"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The severity of the incident"
        },
        "status": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "New",
                "Active",
                "Closed"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The status of the incident"
        },
        "title": {
          "type": "string",
          "description": "The title of the incident"
        }
      },
      "required": [
        "severity",
        "status",
        "title"
      ]
    },
    "McasDataConnector": {
      "type": "object",
      "properties": {
        "kind": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "MicrosoftCloudAppSecurity"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The data connector kind"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/McasDataConnectorProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "MCAS (Microsoft Cloud App Security) data connector properties."
        }
      },
      "required": [
        "kind"
      ]
    },
    "McasDataConnectorDataTypes": {
      "type": "object",
      "properties": {
        "alerts": {
          "oneOf": [
            {
              "$ref": "#/definitions/DataConnectorDataTypeCommon"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Alerts data type connection."
        },
        "discoveryLogs": {
          "oneOf": [
            {
              "$ref": "#/definitions/DataConnectorDataTypeCommon"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Discovery log data type connection."
        }
      }
    },
    "McasDataConnectorProperties": {
      "type": "object",
      "properties": {
        "dataTypes": {
          "oneOf": [
            {
              "$ref": "#/definitions/McasDataConnectorDataTypes"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The available data types for the connector."
        },
        "tenantId": {
          "type": "string",
          "description": "The tenant id to connect to, and get the data from."
        }
      }
    },
    "MdatpDataConnector": {
      "type": "object",
      "properties": {
        "kind": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "MicrosoftDefenderAdvancedThreatProtection"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The data connector kind"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/MdatpDataConnectorProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "MDATP (Microsoft Defender Advanced Threat Protection) data connector properties."
        }
      },
      "required": [
        "kind"
      ]
    },
    "MdatpDataConnectorProperties": {
      "type": "object",
      "properties": {
        "dataTypes": {
          "oneOf": [
            {
              "$ref": "#/definitions/AlertsDataTypeOfDataConnector"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The available data types for the connector."
        },
        "tenantId": {
          "type": "string",
          "description": "The tenant id to connect to, and get the data from."
        }
      }
    },
    "MicrosoftSecurityIncidentCreationAlertRule": {
      "type": "object",
      "properties": {
        "kind": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "MicrosoftSecurityIncidentCreation"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The alert rule kind"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/MicrosoftSecurityIncidentCreationAlertRuleProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "MicrosoftSecurityIncidentCreation rule properties"
        }
      },
      "required": [
        "kind"
      ]
    },
    "MicrosoftSecurityIncidentCreationAlertRuleProperties": {
      "type": "object",
      "properties": {
        "alertRuleTemplateName": {
          "type": "string",
          "description": "The Name of the alert rule template used to create this rule."
        },
        "description": {
          "type": "string",
          "description": "The description of the alert rule."
        },
        "displayName": {
          "type": "string",
          "description": "The display name for alerts created by this alert rule."
        },
        "displayNamesExcludeFilter": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "the alerts' displayNames on which the cases will not be generated"
        },
        "displayNamesFilter": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "the alerts' displayNames on which the cases will be generated"
        },
        "enabled": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Determines whether this alert rule is enabled or disabled."
        },
        "productFilter": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Microsoft Cloud App Security",
                "Azure Security Center",
                "Azure Advanced Threat Protection",
                "Azure Active Directory Identity Protection",
                "Azure Security Center for IoT"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The alerts' productName on which the cases will be generated"
        },
        "severitiesFilter": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "High",
                  "Medium",
                  "Low",
                  "Informational"
                ]
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "the alerts' severities on which the cases will be generated"
        }
      },
      "required": [
        "displayName",
        "enabled",
        "productFilter"
      ]
    },
    "MicrosoftSecurityIncidentCreationAlertRuleTemplate": {
      "type": "object",
      "properties": {
        "kind": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "MicrosoftSecurityIncidentCreation"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The alert rule kind"
        }
      },
      "required": [
        "kind"
      ]
    },
    "OfficeDataConnector": {
      "type": "object",
      "properties": {
        "kind": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Office365"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The data connector kind"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/OfficeDataConnectorProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Office data connector properties."
        }
      },
      "required": [
        "kind"
      ]
    },
    "OfficeDataConnectorDataTypes": {
      "type": "object",
      "properties": {
        "exchange": {
          "oneOf": [
            {
              "$ref": "#/definitions/OfficeDataConnectorDataTypesExchange"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Exchange data type connection."
        },
        "sharePoint": {
          "oneOf": [
            {
              "$ref": "#/definitions/OfficeDataConnectorDataTypesSharePoint"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "SharePoint data type connection."
        },
        "teams": {
          "oneOf": [
            {
              "$ref": "#/definitions/OfficeDataConnectorDataTypesTeams"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Teams data type connection."
        }
      }
    },
    "OfficeDataConnectorDataTypesExchange": {
      "type": "object",
      "properties": {
        "state": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Enabled",
                "Disabled"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describe whether this data type connection is enabled or not."
        }
      }
    },
    "OfficeDataConnectorDataTypesSharePoint": {
      "type": "object",
      "properties": {
        "state": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Enabled",
                "Disabled"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describe whether this data type connection is enabled or not."
        }
      }
    },
    "OfficeDataConnectorDataTypesTeams": {
      "type": "object",
      "properties": {
        "state": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Enabled",
                "Disabled"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describe whether this data type connection is enabled or not."
        }
      }
    },
    "OfficeDataConnectorProperties": {
      "type": "object",
      "properties": {
        "dataTypes": {
          "oneOf": [
            {
              "$ref": "#/definitions/OfficeDataConnectorDataTypes"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The available data types for the connector."
        },
        "tenantId": {
          "type": "string",
          "description": "The tenant id to connect to, and get the data from."
        }
      }
    },
    "ScheduledAlertRule": {
      "type": "object",
      "properties": {
        "kind": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Scheduled"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The alert rule kind"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/ScheduledAlertRuleProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Scheduled alert rule properties"
        }
      },
      "required": [
        "kind"
      ]
    },
    "ScheduledAlertRuleProperties": {
      "type": "object",
      "properties": {
        "alertRuleTemplateName": {
          "type": "string",
          "description": "The Name of the alert rule template used to create this rule."
        },
        "description": {
          "type": "string",
          "description": "The description of the alert rule."
        },
        "displayName": {
          "type": "string",
          "description": "The display name for alerts created by this alert rule."
        },
        "enabled": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Determines whether this alert rule is enabled or disabled."
        },
        "query": {
          "type": "string",
          "description": "The query that creates alerts for this rule."
        },
        "queryFrequency": {
          "type": "string",
          "description": "The frequency (in ISO 8601 duration format) for this alert rule to run."
        },
        "queryPeriod": {
          "type": "string",
          "description": "The period (in ISO 8601 duration format) that this alert rule looks at."
        },
        "severity": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "High",
                "Medium",
                "Low",
                "Informational"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The severity for alerts created by this alert rule."
        },
        "suppressionDuration": {
          "type": "string",
          "description": "The suppression (in ISO 8601 duration format) to wait since last time this alert rule been triggered."
        },
        "suppressionEnabled": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Determines whether the suppression for this alert rule is enabled or disabled."
        },
        "tactics": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "InitialAccess",
                  "Execution",
                  "Persistence",
                  "PrivilegeEscalation",
                  "DefenseEvasion",
                  "CredentialAccess",
                  "Discovery",
                  "LateralMovement",
                  "Collection",
                  "Exfiltration",
                  "CommandAndControl",
                  "Impact"
                ]
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The tactics of the alert rule"
        },
        "triggerOperator": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "GreaterThan",
                "LessThan",
                "Equal",
                "NotEqual"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The operation against the threshold that triggers alert rule."
        },
        "triggerThreshold": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The threshold triggers this alert rule."
        }
      },
      "required": [
        "displayName",
        "enabled",
        "suppressionDuration",
        "suppressionEnabled"
      ]
    },
    "ScheduledAlertRuleTemplate": {
      "type": "object",
      "properties": {
        "kind": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Scheduled"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The alert rule kind"
        }
      },
      "required": [
        "kind"
      ]
    },
    "TIDataConnector": {
      "type": "object",
      "properties": {
        "kind": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "ThreatIntelligence"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The data connector kind"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/TIDataConnectorProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "TI (Threat Intelligence) data connector properties."
        }
      },
      "required": [
        "kind"
      ]
    },
    "TIDataConnectorDataTypes": {
      "type": "object",
      "properties": {
        "indicators": {
          "oneOf": [
            {
              "$ref": "#/definitions/TIDataConnectorDataTypesIndicators"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Data type for indicators connection."
        }
      }
    },
    "TIDataConnectorDataTypesIndicators": {
      "type": "object",
      "properties": {
        "state": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Enabled",
                "Disabled"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describe whether this data type connection is enabled or not."
        }
      }
    },
    "TIDataConnectorProperties": {
      "type": "object",
      "properties": {
        "dataTypes": {
          "oneOf": [
            {
              "$ref": "#/definitions/TIDataConnectorDataTypes"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The available data types for the connector."
        },
        "tenantId": {
          "type": "string",
          "description": "The tenant id to connect to, and get the data from."
        },
        "tipLookbackPeriod": {
          "type": "string",
          "description": "The lookback period for the feed to be imported."
        }
      }
    },
    "UserInfo": {
      "type": "object",
      "properties": {
        "objectId": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$",
              "minLength": 36,
              "maxLength": 36
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The object id of the user."
        }
      },
      "required": [
        "objectId"
      ]
    },
    "alertRules_actions_childResource": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2020-01-01"
          ]
        },
        "name": {
          "type": "string",
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "actions"
          ]
        },
        "etag": {
          "type": "string",
          "description": "Etag of the azure resource"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/ActionRequestPropertiesOrActionResponseProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Action properties for put request"
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.SecurityInsights/alertRules/actions"
    },
    "incidents_comments_childResource": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2020-01-01"
          ]
        },
        "name": {
          "type": "string",
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "comments"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/IncidentCommentProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Incident comment properties"
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.SecurityInsights/incidents/comments"
    }
  }
}