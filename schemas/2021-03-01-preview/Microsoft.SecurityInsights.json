{
  "id": "https://schema.management.azure.com/schemas/2021-03-01-preview/Microsoft.SecurityInsights.json#",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "Microsoft.SecurityInsights",
  "description": "Microsoft SecurityInsights Resource Types",
  "resourceDefinitions": {},
  "extension_resourceDefinitions": {
    "settings": {
      "type": "object",
      "oneOf": [
        {
          "$ref": "#/definitions/EyesOn"
        },
        {
          "$ref": "#/definitions/EntityAnalytics"
        },
        {
          "$ref": "#/definitions/Ueba"
        }
      ],
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2021-03-01-preview"
          ]
        },
        "etag": {
          "type": "string",
          "description": "Etag of the azure resource"
        },
        "name": {
          "type": "string",
          "description": "The setting name. Supports - EyesOn, EntityAnalytics, Ueba"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.SecurityInsights/settings"
          ]
        }
      },
      "required": [
        "apiVersion",
        "name",
        "type"
      ],
      "description": "Microsoft.SecurityInsights/settings"
    },
    "watchlists": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2021-03-01-preview"
          ]
        },
        "etag": {
          "type": "string",
          "description": "Etag of the azure resource"
        },
        "name": {
          "type": "string",
          "description": "Watchlist Alias"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/WatchlistProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describes watchlist properties"
        },
        "resources": {
          "type": "array",
          "items": {
            "oneOf": [
              {
                "$ref": "#/definitions/watchlists_watchlistItems_childResource"
              }
            ]
          }
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.SecurityInsights/watchlists"
          ]
        }
      },
      "required": [
        "apiVersion",
        "name",
        "properties",
        "type"
      ],
      "description": "Microsoft.SecurityInsights/watchlists"
    },
    "watchlists_watchlistItems": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2021-03-01-preview"
          ]
        },
        "etag": {
          "type": "string",
          "description": "Etag of the azure resource"
        },
        "name": {
          "type": "string",
          "description": "Watchlist Item Id (GUID)"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/WatchlistItemProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describes watchlist item properties"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.SecurityInsights/watchlists/watchlistItems"
          ]
        }
      },
      "required": [
        "apiVersion",
        "name",
        "properties",
        "type"
      ],
      "description": "Microsoft.SecurityInsights/watchlists/watchlistItems"
    }
  },
  "definitions": {
    "EntityAnalytics": {
      "type": "object",
      "properties": {
        "kind": {
          "type": "string",
          "enum": [
            "EntityAnalytics"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/EntityAnalyticsProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "EntityAnalytics property bag."
        }
      },
      "required": [
        "kind"
      ],
      "description": "Settings with single toggle."
    },
    "EntityAnalyticsProperties": {
      "type": "object",
      "properties": {},
      "description": "EntityAnalytics property bag."
    },
    "EyesOn": {
      "type": "object",
      "properties": {
        "kind": {
          "type": "string",
          "enum": [
            "EyesOn"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/EyesOnSettingsProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "EyesOn property bag."
        }
      },
      "required": [
        "kind"
      ],
      "description": "Settings with single toggle."
    },
    "EyesOnSettingsProperties": {
      "type": "object",
      "properties": {},
      "description": "EyesOn property bag."
    },
    "Ueba": {
      "type": "object",
      "properties": {
        "kind": {
          "type": "string",
          "enum": [
            "Ueba"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/UebaProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Ueba property bag."
        }
      },
      "required": [
        "kind"
      ],
      "description": "Settings with single toggle."
    },
    "UebaProperties": {
      "type": "object",
      "properties": {
        "dataSources": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "AuditLogs",
                  "AzureActivity",
                  "SecurityEvent",
                  "SigninLogs"
                ]
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The relevant data sources that enriched by ueba"
        }
      },
      "description": "Ueba property bag."
    },
    "UserInfo": {
      "type": "object",
      "properties": {
        "objectId": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[0-9a-fA-F]{8}(-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The object id of the user."
        }
      },
      "description": "User information that made some action"
    },
    "WatchlistItemProperties": {
      "type": "object",
      "properties": {
        "created": {
          "type": "string",
          "format": "date-time",
          "description": "The time the watchlist item was created"
        },
        "createdBy": {
          "oneOf": [
            {
              "$ref": "#/definitions/UserInfo"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "User information that made some action"
        },
        "entityMapping": {
          "type": "object",
          "properties": {},
          "description": "key-value pairs for a watchlist item entity mapping"
        },
        "isDeleted": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "A flag that indicates if the watchlist item is deleted or not"
        },
        "itemsKeyValue": {
          "type": "object",
          "properties": {},
          "description": "key-value pairs for a watchlist item"
        },
        "tenantId": {
          "type": "string",
          "description": "The tenantId to which the watchlist item belongs to"
        },
        "updated": {
          "type": "string",
          "format": "date-time",
          "description": "The last time the watchlist item was updated"
        },
        "updatedBy": {
          "oneOf": [
            {
              "$ref": "#/definitions/UserInfo"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "User information that made some action"
        },
        "watchlistItemId": {
          "type": "string",
          "description": "The id (a Guid) of the watchlist item"
        },
        "watchlistItemType": {
          "type": "string",
          "description": "The type of the watchlist item"
        }
      },
      "required": [
        "itemsKeyValue"
      ],
      "description": "Describes watchlist item properties"
    },
    "WatchlistProperties": {
      "type": "object",
      "properties": {
        "contentType": {
          "type": "string",
          "description": "The content type of the raw content. Example : text/csv or text/tsv "
        },
        "created": {
          "type": "string",
          "format": "date-time",
          "description": "The time the watchlist was created"
        },
        "createdBy": {
          "oneOf": [
            {
              "$ref": "#/definitions/UserInfo"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "User information that made some action"
        },
        "defaultDuration": {
          "type": "string",
          "format": "duration",
          "description": "The default duration of a watchlist (in ISO 8601 duration format)"
        },
        "description": {
          "type": "string",
          "description": "A description of the watchlist"
        },
        "displayName": {
          "type": "string",
          "description": "The display name of the watchlist"
        },
        "isDeleted": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "A flag that indicates if the watchlist is deleted or not"
        },
        "itemsSearchKey": {
          "type": "string",
          "description": "The search key is used to optimize query performance when using watchlists for joins with other data. For example, enable a column with IP addresses to be the designated SearchKey field, then use this field as the key field when joining to other event data by IP address."
        },
        "labels": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "List of labels relevant to this watchlist"
        },
        "numberOfLinesToSkip": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The number of lines in a csv/tsv content to skip before the header"
        },
        "provider": {
          "type": "string",
          "description": "The provider of the watchlist"
        },
        "rawContent": {
          "type": "string",
          "description": "The raw content that represents to watchlist items to create. In case of csv/tsv content type, it's the content of the file that will parsed by the endpoint"
        },
        "source": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Local file",
                "Remote storage"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The source of the watchlist."
        },
        "tenantId": {
          "type": "string",
          "description": "The tenantId where the watchlist belongs to"
        },
        "updated": {
          "type": "string",
          "format": "date-time",
          "description": "The last time the watchlist was updated"
        },
        "updatedBy": {
          "oneOf": [
            {
              "$ref": "#/definitions/UserInfo"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "User information that made some action"
        },
        "uploadStatus": {
          "type": "string",
          "description": "The status of the Watchlist upload : New, InProgress or Complete. Pls note : When a Watchlist upload status is equal to InProgress, the Watchlist cannot be deleted"
        },
        "watchlistAlias": {
          "type": "string",
          "description": "The alias of the watchlist"
        },
        "watchlistId": {
          "type": "string",
          "description": "The id (a Guid) of the watchlist"
        },
        "watchlistItemsCount": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The number of Watchlist Items in the Watchlist"
        },
        "watchlistType": {
          "type": "string",
          "description": "The type of the watchlist"
        }
      },
      "required": [
        "displayName",
        "itemsSearchKey",
        "provider",
        "source"
      ],
      "description": "Describes watchlist properties"
    },
    "watchlists_watchlistItems_childResource": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2021-03-01-preview"
          ]
        },
        "etag": {
          "type": "string",
          "description": "Etag of the azure resource"
        },
        "name": {
          "type": "string",
          "description": "Watchlist Item Id (GUID)"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/WatchlistItemProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describes watchlist item properties"
        },
        "type": {
          "type": "string",
          "enum": [
            "watchlistItems"
          ]
        }
      },
      "required": [
        "apiVersion",
        "name",
        "properties",
        "type"
      ],
      "description": "Microsoft.SecurityInsights/watchlists/watchlistItems"
    }
  }
}