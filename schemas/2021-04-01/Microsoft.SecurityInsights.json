{
  "id": "https://schema.management.azure.com/schemas/2021-04-01/Microsoft.SecurityInsights.json#",
  "title": "Microsoft.SecurityInsights",
  "description": "Microsoft SecurityInsights Resource Types",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "definitions": {
    "IncidentCommentProperties": {
      "type": "object",
      "properties": {
        "message": {
          "type": "string",
          "description": "The comment message"
        }
      },
      "required": [
        "message"
      ]
    },
    "IncidentLabel": {
      "type": "object",
      "properties": {
        "labelName": {
          "type": "string",
          "description": "The name of the label"
        }
      },
      "required": [
        "labelName"
      ]
    },
    "IncidentOwnerInfo": {
      "type": "object",
      "properties": {
        "assignedTo": {
          "type": "string",
          "description": "The name of the user the incident is assigned to."
        },
        "email": {
          "type": "string",
          "description": "The email of the user the incident is assigned to."
        },
        "objectId": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$",
              "minLength": 36,
              "maxLength": 36
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The object id of the user the incident is assigned to."
        },
        "userPrincipalName": {
          "type": "string",
          "description": "The user principal name of the user the incident is assigned to."
        }
      }
    },
    "IncidentProperties": {
      "type": "object",
      "properties": {
        "classification": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Undetermined",
                "TruePositive",
                "BenignPositive",
                "FalsePositive"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The reason the incident was closed"
        },
        "classificationComment": {
          "type": "string",
          "description": "Describes the reason the incident was closed"
        },
        "classificationReason": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "SuspiciousActivity",
                "SuspiciousButExpected",
                "IncorrectAlertLogic",
                "InaccurateData"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The classification reason the incident was closed with"
        },
        "description": {
          "type": "string",
          "description": "The description of the incident"
        },
        "firstActivityTimeUtc": {
          "type": "string",
          "description": "The time of the first activity in the incident"
        },
        "labels": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/IncidentLabel"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "List of labels relevant to this incident"
        },
        "lastActivityTimeUtc": {
          "type": "string",
          "description": "The time of the last activity in the incident"
        },
        "owner": {
          "oneOf": [
            {
              "$ref": "#/definitions/IncidentOwnerInfo"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describes a user that the incident is assigned to"
        },
        "severity": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "High",
                "Medium",
                "Low",
                "Informational"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The severity of the incident"
        },
        "status": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "New",
                "Active",
                "Closed"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The status of the incident"
        },
        "title": {
          "type": "string",
          "description": "The title of the incident"
        }
      },
      "required": [
        "severity",
        "status",
        "title"
      ]
    },
    "RelationProperties": {
      "type": "object",
      "properties": {
        "relatedResourceId": {
          "type": "string",
          "description": "The resource ID of the related resource"
        }
      },
      "required": [
        "relatedResourceId"
      ]
    },
    "ThreatIntelligenceExternalReference": {
      "type": "object",
      "properties": {
        "description": {
          "type": "string",
          "description": "External reference description"
        },
        "externalId": {
          "type": "string",
          "description": "External reference ID"
        },
        "hashes": {
          "oneOf": [
            {
              "$ref": "#/definitions/ThreatIntelligenceExternalReferenceHashes"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "External reference hashes"
        },
        "sourceName": {
          "type": "string",
          "description": "External reference source name"
        },
        "url": {
          "type": "string",
          "description": "External reference URL"
        }
      }
    },
    "ThreatIntelligenceExternalReferenceHashes": {
      "type": "object",
      "properties": {},
      "additionalProperties": {
        "type": "string"
      }
    },
    "ThreatIntelligenceGranularMarkingModel": {
      "type": "object",
      "properties": {
        "language": {
          "type": "string",
          "description": "Language granular marking model"
        },
        "markingRef": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "marking reference granular marking model"
        },
        "selectors": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "granular marking model selectors"
        }
      }
    },
    "ThreatIntelligenceIndicatorProperties": {
      "type": "object",
      "properties": {
        "confidence": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Confidence of threat intelligence entity"
        },
        "created": {
          "type": "string",
          "description": "Created by"
        },
        "createdByRef": {
          "type": "string",
          "description": "Created by reference of threat intelligence entity"
        },
        "defanged": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Is threat intelligence entity defanged"
        },
        "description": {
          "type": "string",
          "description": "Description of a threat intelligence entity"
        },
        "displayName": {
          "type": "string",
          "description": "Display name of a threat intelligence entity"
        },
        "extensions": {
          "oneOf": [
            {
              "$ref": "#/definitions/ThreatIntelligenceIndicatorPropertiesExtensions"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Extensions map"
        },
        "externalId": {
          "type": "string",
          "description": "External ID of threat intelligence entity"
        },
        "externalLastUpdatedTimeUtc": {
          "type": "string",
          "description": "External last updated time in UTC"
        },
        "externalReferences": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ThreatIntelligenceExternalReference"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "External References"
        },
        "granularMarkings": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ThreatIntelligenceGranularMarkingModel"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Granular Markings"
        },
        "indicatorTypes": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Indicator types of threat intelligence entities"
        },
        "killChainPhases": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ThreatIntelligenceKillChainPhase"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Kill chain phases"
        },
        "labels": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Labels  of threat intelligence entity"
        },
        "language": {
          "type": "string",
          "description": "Language of threat intelligence entity"
        },
        "lastUpdatedTimeUtc": {
          "type": "string",
          "description": "Last updated time in UTC"
        },
        "modified": {
          "type": "string",
          "description": "Modified by"
        },
        "objectMarkingRefs": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Threat intelligence entity object marking references"
        },
        "parsedPattern": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ThreatIntelligenceParsedPattern"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Parsed patterns"
        },
        "pattern": {
          "type": "string",
          "description": "Pattern of a threat intelligence entity"
        },
        "patternType": {
          "type": "string",
          "description": "Pattern type of a threat intelligence entity"
        },
        "patternVersion": {
          "type": "string",
          "description": "Pattern version of a threat intelligence entity"
        },
        "revoked": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Is threat intelligence entity revoked"
        },
        "source": {
          "type": "string",
          "description": "Source of a threat intelligence entity"
        },
        "threatIntelligenceTags": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "List of tags"
        },
        "threatTypes": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Threat types"
        },
        "validFrom": {
          "type": "string",
          "description": "Valid from"
        },
        "validUntil": {
          "type": "string",
          "description": "Valid until"
        }
      }
    },
    "ThreatIntelligenceIndicatorPropertiesExtensions": {
      "type": "object",
      "properties": {},
      "additionalProperties": {}
    },
    "ThreatIntelligenceKillChainPhase": {
      "type": "object",
      "properties": {
        "killChainName": {
          "type": "string",
          "description": "Kill chainName name"
        },
        "phaseName": {
          "type": "string",
          "description": "Phase name"
        }
      }
    },
    "ThreatIntelligenceParsedPattern": {
      "type": "object",
      "properties": {
        "patternTypeKey": {
          "type": "string",
          "description": "Pattern type key"
        },
        "patternTypeValues": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ThreatIntelligenceParsedPatternTypeValue"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Pattern type keys"
        }
      }
    },
    "ThreatIntelligenceParsedPatternTypeValue": {
      "type": "object",
      "properties": {
        "value": {
          "type": "string",
          "description": "Value of parsed pattern"
        },
        "valueType": {
          "type": "string",
          "description": "Type of the value"
        }
      }
    },
    "UserInfo": {
      "type": "object",
      "properties": {
        "objectId": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$",
              "minLength": 36,
              "maxLength": 36
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The object id of the user."
        }
      }
    },
    "WatchlistItemProperties": {
      "type": "object",
      "properties": {
        "created": {
          "type": "string",
          "description": "The time the watchlist item was created"
        },
        "createdBy": {
          "oneOf": [
            {
              "$ref": "#/definitions/UserInfo"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describes a user that created the watchlist item"
        },
        "entityMapping": {
          "oneOf": [
            {},
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "key-value pairs for a watchlist item entity mapping"
        },
        "isDeleted": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "A flag that indicates if the watchlist item is deleted or not"
        },
        "itemsKeyValue": {
          "oneOf": [
            {},
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "key-value pairs for a watchlist item"
        },
        "tenantId": {
          "type": "string",
          "description": "The tenantId to which the watchlist item belongs to"
        },
        "updated": {
          "type": "string",
          "description": "The last time the watchlist item was updated"
        },
        "updatedBy": {
          "oneOf": [
            {
              "$ref": "#/definitions/UserInfo"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describes a user that updated the watchlist item"
        },
        "watchlistItemId": {
          "type": "string",
          "description": "The id (a Guid) of the watchlist item"
        },
        "watchlistItemType": {
          "type": "string",
          "description": "The type of the watchlist item"
        }
      },
      "required": [
        "itemsKeyValue"
      ]
    },
    "WatchlistProperties": {
      "type": "object",
      "properties": {
        "contentType": {
          "type": "string",
          "description": "The content type of the raw content. For now, only text/csv is valid"
        },
        "created": {
          "type": "string",
          "description": "The time the watchlist was created"
        },
        "createdBy": {
          "oneOf": [
            {
              "$ref": "#/definitions/UserInfo"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describes a user that created the watchlist"
        },
        "defaultDuration": {
          "type": "string",
          "description": "The default duration of a watchlist (in ISO 8601 duration format)"
        },
        "description": {
          "type": "string",
          "description": "A description of the watchlist"
        },
        "displayName": {
          "type": "string",
          "description": "The display name of the watchlist"
        },
        "isDeleted": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "A flag that indicates if the watchlist is deleted or not"
        },
        "itemsSearchKey": {
          "type": "string",
          "description": "The search key is used to optimize query performance when using watchlists for joins with other data. For example, enable a column with IP addresses to be the designated SearchKey field, then use this field as the key field when joining to other event data by IP address."
        },
        "labels": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "List of labels relevant to this watchlist"
        },
        "numberOfLinesToSkip": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The number of lines in a csv content to skip before the header"
        },
        "provider": {
          "type": "string",
          "description": "The provider of the watchlist"
        },
        "rawContent": {
          "type": "string",
          "description": "The raw content that represents to watchlist items to create. Example : This line will be skipped\nheader1,header2\nvalue1,value2"
        },
        "source": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Local file",
                "Remote storage"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The source of the watchlist"
        },
        "tenantId": {
          "type": "string",
          "description": "The tenantId where the watchlist belongs to"
        },
        "updated": {
          "type": "string",
          "description": "The last time the watchlist was updated"
        },
        "updatedBy": {
          "oneOf": [
            {
              "$ref": "#/definitions/UserInfo"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Describes a user that updated the watchlist"
        },
        "uploadStatus": {
          "type": "string",
          "description": "The status of the Watchlist upload : New, InProgress or Complete. **Note** : When a Watchlist upload status is InProgress, the Watchlist cannot be deleted"
        },
        "watchlistAlias": {
          "type": "string",
          "description": "The alias of the watchlist"
        },
        "watchlistId": {
          "type": "string",
          "description": "The id (a Guid) of the watchlist"
        },
        "watchlistType": {
          "type": "string",
          "description": "The type of the watchlist"
        }
      },
      "required": [
        "displayName",
        "itemsSearchKey",
        "provider",
        "source"
      ]
    },
    "incidents_comments_childResource": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2021-04-01"
          ]
        },
        "name": {
          "type": "string",
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "comments"
          ]
        },
        "etag": {
          "type": "string",
          "description": "Etag of the azure resource"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/IncidentCommentProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Incident comment properties"
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.SecurityInsights/incidents/comments"
    },
    "incidents_relations_childResource": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2021-04-01"
          ]
        },
        "name": {
          "type": "string",
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "relations"
          ]
        },
        "etag": {
          "type": "string",
          "description": "Etag of the azure resource"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/RelationProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Relation properties"
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.SecurityInsights/incidents/relations"
    },
    "watchlists_watchlistItems_childResource": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2021-04-01"
          ]
        },
        "name": {
          "type": "string",
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "watchlistItems"
          ]
        },
        "etag": {
          "type": "string",
          "description": "Etag of the azure resource"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/WatchlistItemProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Watchlist Item properties"
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.SecurityInsights/watchlists/watchlistItems"
    }
  }
}