{
  "id": "https://schema.management.azure.com/schemas/2021-08-01/Microsoft.AzureArcData.json#",
  "title": "Microsoft.AzureArcData",
  "description": "Microsoft AzureArcData Resource Types",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "resourceDefinitions": {
    "dataControllers": {
      "description": "Microsoft.AzureArcData/dataControllers",
      "properties": {
        "apiVersion": {
          "enum": [
            "2021-08-01"
          ],
          "type": "string"
        },
        "extendedLocation": {
          "description": "The extendedLocation of the resource.",
          "oneOf": [
            {
              "$ref": "#/definitions/ExtendedLocation"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "location": {
          "description": "The geo-location where the resource lives",
          "type": "string"
        },
        "name": {
          "description": "",
          "type": "string"
        },
        "properties": {
          "description": "The data controller's properties",
          "oneOf": [
            {
              "$ref": "#/definitions/DataControllerProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "tags": {
          "description": "Resource tags.",
          "oneOf": [
            {
              "additionalProperties": {
                "type": "string"
              },
              "properties": {},
              "type": "object"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "type": {
          "enum": [
            "Microsoft.AzureArcData/dataControllers"
          ],
          "type": "string"
        }
      },
      "required": [
        "name",
        "properties",
        "apiVersion",
        "type"
      ],
      "type": "object"
    },
    "sqlManagedInstances": {
      "description": "Microsoft.AzureArcData/sqlManagedInstances",
      "properties": {
        "apiVersion": {
          "enum": [
            "2021-08-01"
          ],
          "type": "string"
        },
        "extendedLocation": {
          "description": "The extendedLocation of the resource.",
          "oneOf": [
            {
              "$ref": "#/definitions/ExtendedLocation"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "location": {
          "description": "The geo-location where the resource lives",
          "type": "string"
        },
        "name": {
          "description": "The name of SQL Managed Instances",
          "type": "string"
        },
        "properties": {
          "description": "null",
          "oneOf": [
            {
              "$ref": "#/definitions/SqlManagedInstanceProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "sku": {
          "description": "Resource sku.",
          "oneOf": [
            {
              "$ref": "#/definitions/SqlManagedInstanceSku"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "tags": {
          "description": "Resource tags.",
          "oneOf": [
            {
              "additionalProperties": {
                "type": "string"
              },
              "properties": {},
              "type": "object"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "type": {
          "enum": [
            "Microsoft.AzureArcData/sqlManagedInstances"
          ],
          "type": "string"
        }
      },
      "required": [
        "name",
        "properties",
        "apiVersion",
        "type"
      ],
      "type": "object"
    },
    "sqlServerInstances": {
      "description": "Microsoft.AzureArcData/sqlServerInstances",
      "properties": {
        "apiVersion": {
          "enum": [
            "2021-08-01"
          ],
          "type": "string"
        },
        "location": {
          "description": "The geo-location where the resource lives",
          "type": "string"
        },
        "name": {
          "description": "The name of SQL Server Instance",
          "type": "string"
        },
        "properties": {
          "description": "null",
          "oneOf": [
            {
              "$ref": "#/definitions/SqlServerInstanceProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "tags": {
          "description": "Resource tags.",
          "oneOf": [
            {
              "additionalProperties": {
                "type": "string"
              },
              "properties": {},
              "type": "object"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "type": {
          "enum": [
            "Microsoft.AzureArcData/sqlServerInstances"
          ],
          "type": "string"
        }
      },
      "required": [
        "name",
        "properties",
        "apiVersion",
        "type"
      ],
      "type": "object"
    }
  },
  "definitions": {
    "BasicLoginInformation": {
      "description": "Username and password for basic login authentication.",
      "properties": {
        "password": {
          "description": "Login password.",
          "type": "string"
        },
        "username": {
          "description": "Login username.",
          "type": "string"
        }
      },
      "type": "object"
    },
    "DataControllerProperties": {
      "description": "The data controller properties.",
      "properties": {
        "basicLoginInformation": {
          "description": "Username and password for basic login authentication.",
          "oneOf": [
            {
              "$ref": "#/definitions/BasicLoginInformation"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "clusterId": {
          "description": "If a CustomLocation is provided, this contains the ARM id of the connected cluster the custom location belongs to.",
          "type": "string"
        },
        "extensionId": {
          "description": "If a CustomLocation is provided, this contains the ARM id of the extension the custom location belongs to.",
          "type": "string"
        },
        "infrastructure": {
          "description": "The infrastructure the data controller is running on.",
          "oneOf": [
            {
              "enum": [
                "azure",
                "gcp",
                "aws",
                "alibaba",
                "onpremises",
                "other"
              ],
              "type": "string"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "k8sRaw": {
          "description": "The raw kubernetes information",
          "oneOf": [
            {
              "type": "object"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "lastUploadedDate": {
          "description": "Last uploaded date from Kubernetes cluster. Defaults to current date time",
          "format": "date-time",
          "type": "string"
        },
        "logAnalyticsWorkspaceConfig": {
          "description": "Log analytics workspace id and primary key",
          "oneOf": [
            {
              "$ref": "#/definitions/LogAnalyticsWorkspaceConfig"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "onPremiseProperty": {
          "description": "Properties from the Kubernetes data controller",
          "oneOf": [
            {
              "$ref": "#/definitions/OnPremiseProperty"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "uploadServicePrincipal": {
          "description": "Service principal for uploading billing, metrics and logs.",
          "oneOf": [
            {
              "$ref": "#/definitions/UploadServicePrincipal"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "uploadWatermark": {
          "description": "Properties on upload watermark.  Mostly timestamp for each upload data type",
          "oneOf": [
            {
              "$ref": "#/definitions/UploadWatermark"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        }
      },
      "type": "object"
    },
    "ExtendedLocation": {
      "description": "The complex type of the extended location.",
      "properties": {
        "name": {
          "description": "The name of the extended location.",
          "type": "string"
        },
        "type": {
          "description": "The type of the extended location.",
          "oneOf": [
            {
              "enum": [
                "CustomLocation"
              ],
              "type": "string"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        }
      },
      "type": "object"
    },
    "K8SResourceRequirements": {
      "additionalProperties": {},
      "description": "The kubernetes resource limits and requests used to restrict or reserve resource usage.",
      "properties": {
        "limits": {
          "description": "Limits for a kubernetes resource type (e.g 'cpu', 'memory'). The 'cpu' request must be less than or equal to 'cpu' limit. Default 'cpu' is 2, minimum is 1. Default 'memory' is '4Gi', minimum is '2Gi. If sku.tier is GeneralPurpose, maximum 'cpu' is 24 and maximum 'memory' is '128Gi'.",
          "oneOf": [
            {
              "additionalProperties": {
                "type": "string"
              },
              "properties": {},
              "type": "object"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "requests": {
          "description": "Requests for a kubernetes resource type (e.g 'cpu', 'memory'). The 'cpu' request must be less than or equal to 'cpu' limit. Default 'cpu' is 2, minimum is 1. Default 'memory' is '4Gi', minimum is '2Gi. If sku.tier is GeneralPurpose, maximum 'cpu' is 24 and maximum 'memory' is '128Gi'.",
          "oneOf": [
            {
              "additionalProperties": {
                "type": "string"
              },
              "properties": {},
              "type": "object"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        }
      },
      "type": "object"
    },
    "K8SScheduling": {
      "additionalProperties": {},
      "description": "The kubernetes scheduling information.",
      "properties": {
        "default": {
          "description": "The kubernetes scheduling options. It describes restrictions used to help Kubernetes select appropriate nodes to host the database service",
          "oneOf": [
            {
              "$ref": "#/definitions/K8SSchedulingOptions"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        }
      },
      "type": "object"
    },
    "K8SSchedulingOptions": {
      "additionalProperties": {},
      "description": "The kubernetes scheduling options. It describes restrictions used to help Kubernetes select appropriate nodes to host the database service",
      "properties": {
        "resources": {
          "description": "The kubernetes resource limits and requests used to restrict or reserve resource usage.",
          "oneOf": [
            {
              "$ref": "#/definitions/K8SResourceRequirements"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        }
      },
      "type": "object"
    },
    "LogAnalyticsWorkspaceConfig": {
      "description": "Log analytics workspace id and primary key",
      "properties": {
        "primaryKey": {
          "description": "Primary key of the workspace",
          "type": "string"
        },
        "workspaceId": {
          "description": "Azure Log Analytics workspace ID",
          "oneOf": [
            {
              "pattern": "^[0-9a-fA-F]{8}(-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}$",
              "type": "string"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        }
      },
      "type": "object"
    },
    "OnPremiseProperty": {
      "description": "Properties from the Kubernetes data controller",
      "properties": {
        "id": {
          "description": "A globally unique ID identifying the associated Kubernetes cluster",
          "oneOf": [
            {
              "pattern": "^[0-9a-fA-F]{8}(-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}$",
              "type": "string"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "publicSigningKey": {
          "description": "Certificate that contains the Kubernetes cluster public key used to verify signing",
          "type": "string"
        },
        "signingCertificateThumbprint": {
          "description": "Unique thumbprint returned to customer to verify the certificate being uploaded",
          "type": "string"
        }
      },
      "required": [
        "id",
        "publicSigningKey"
      ],
      "type": "object"
    },
    "SqlManagedInstanceK8SRaw": {
      "additionalProperties": {},
      "description": "The raw kubernetes information.",
      "properties": {
        "spec": {
          "description": "The kubernetes spec information.",
          "oneOf": [
            {
              "$ref": "#/definitions/SqlManagedInstanceK8SSpec"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        }
      },
      "type": "object"
    },
    "SqlManagedInstanceK8SSpec": {
      "additionalProperties": {},
      "description": "The kubernetes spec information.",
      "properties": {
        "replicas": {
          "description": "This option specifies the number of SQL Managed Instance replicas that will be deployed in your Kubernetes cluster for high availability purposes. If sku.tier is BusinessCritical, allowed values are '2' or '3' with default of '3'. If sku.tier is GeneralPurpose, replicas must be '1'.",
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "scheduling": {
          "description": "The kubernetes scheduling information.",
          "oneOf": [
            {
              "$ref": "#/definitions/K8SScheduling"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        }
      },
      "type": "object"
    },
    "SqlManagedInstanceProperties": {
      "description": "Properties of sqlManagedInstance.",
      "properties": {
        "admin": {
          "description": "The instance admin user",
          "type": "string"
        },
        "basicLoginInformation": {
          "description": "Username and password for basic authentication.",
          "oneOf": [
            {
              "$ref": "#/definitions/BasicLoginInformation"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "clusterId": {
          "description": "If a CustomLocation is provided, this contains the ARM id of the connected cluster the custom location belongs to.",
          "type": "string"
        },
        "dataControllerId": {
          "description": "null",
          "type": "string"
        },
        "endTime": {
          "description": "The instance end time",
          "type": "string"
        },
        "extensionId": {
          "description": "If a CustomLocation is provided, this contains the ARM id of the extension the custom location belongs to.",
          "type": "string"
        },
        "k8sRaw": {
          "description": "The raw kubernetes information",
          "oneOf": [
            {
              "$ref": "#/definitions/SqlManagedInstanceK8SRaw"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "lastUploadedDate": {
          "description": "Last uploaded date from Kubernetes cluster. Defaults to current date time",
          "format": "date-time",
          "type": "string"
        },
        "licenseType": {
          "description": "The license type to apply for this managed instance.",
          "oneOf": [
            {
              "enum": [
                "BasePrice",
                "LicenseIncluded"
              ],
              "type": "string"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "startTime": {
          "description": "The instance start time",
          "type": "string"
        }
      },
      "type": "object"
    },
    "SqlManagedInstanceSku": {
      "description": "The resource model definition representing SKU for Azure Managed Instance - Azure Arc",
      "properties": {
        "capacity": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "dev": {
          "description": "Whether dev/test is enabled. When the dev field is set to true, the resource is used for dev/test purpose. ",
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "family": {
          "type": "string"
        },
        "name": {
          "description": "The name of the SKU.",
          "oneOf": [
            {
              "enum": [
                "vCore"
              ],
              "type": "string"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "size": {
          "description": "The SKU size. When the name field is the combination of tier and some other value, this would be the standalone code. ",
          "type": "string"
        },
        "tier": {
          "description": "The pricing tier for the instance.",
          "oneOf": [
            {
              "enum": [
                "GeneralPurpose",
                "BusinessCritical"
              ],
              "type": "string"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        }
      },
      "required": [
        "name"
      ],
      "type": "object"
    },
    "SqlServerInstanceProperties": {
      "description": "Properties of SqlServerInstance.",
      "properties": {
        "azureDefenderStatus": {
          "description": "Status of Azure Defender.",
          "oneOf": [
            {
              "enum": [
                "Protected",
                "Unprotected",
                "Unknown"
              ],
              "type": "string"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "azureDefenderStatusLastUpdated": {
          "description": "Timestamp of last Azure Defender status update.",
          "format": "date-time",
          "type": "string"
        },
        "collation": {
          "description": "SQL Server collation.",
          "type": "string"
        },
        "containerResourceId": {
          "description": "ARM Resource id of the container resource (Azure Arc for Servers).",
          "type": "string"
        },
        "currentVersion": {
          "description": "SQL Server current version.",
          "type": "string"
        },
        "edition": {
          "description": "SQL Server edition.",
          "oneOf": [
            {
              "enum": [
                "Evaluation",
                "Enterprise",
                "Standard",
                "Web",
                "Developer",
                "Express"
              ],
              "type": "string"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "instanceName": {
          "description": "SQL Server instance name.",
          "type": "string"
        },
        "licenseType": {
          "description": "SQL Server license type.",
          "oneOf": [
            {
              "enum": [
                "Paid",
                "Free",
                "HADR",
                "Undefined"
              ],
              "type": "string"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "patchLevel": {
          "description": "SQL Server update level.",
          "type": "string"
        },
        "productId": {
          "description": "SQL Server product ID.",
          "type": "string"
        },
        "status": {
          "description": "The cloud connectivity status.",
          "oneOf": [
            {
              "enum": [
                "Connected",
                "Disconnected",
                "Unknown"
              ],
              "type": "string"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "tcpDynamicPorts": {
          "description": "Dynamic TCP ports used by SQL Server.",
          "type": "string"
        },
        "tcpStaticPorts": {
          "description": "Static TCP ports used by SQL Server.",
          "type": "string"
        },
        "vCore": {
          "description": "The number of logical processors used by the SQL Server instance.",
          "type": "string"
        },
        "version": {
          "description": "SQL Server version.",
          "oneOf": [
            {
              "enum": [
                "SQL Server 2019",
                "SQL Server 2017",
                "SQL Server 2016"
              ],
              "type": "string"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        }
      },
      "required": [
        "containerResourceId",
        "status"
      ],
      "type": "object"
    },
    "UploadServicePrincipal": {
      "description": "Service principal for uploading billing, metrics and logs.",
      "properties": {
        "authority": {
          "description": "Authority for the service principal. Example: https://login.microsoftonline.com/",
          "type": "string"
        },
        "clientId": {
          "description": "Client ID of the service principal for uploading data.",
          "oneOf": [
            {
              "pattern": "^[0-9a-fA-F]{8}(-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}$",
              "type": "string"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        },
        "clientSecret": {
          "description": "Secret of the service principal",
          "type": "string"
        },
        "tenantId": {
          "description": "Tenant ID of the service principal.",
          "oneOf": [
            {
              "pattern": "^[0-9a-fA-F]{8}(-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}$",
              "type": "string"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ]
        }
      },
      "type": "object"
    },
    "UploadWatermark": {
      "description": "Properties on upload watermark.  Mostly timestamp for each upload data type",
      "properties": {
        "logs": {
          "description": "Last uploaded date for logs from kubernetes cluster. Defaults to current date time",
          "format": "date-time",
          "type": "string"
        },
        "metrics": {
          "description": "Last uploaded date for metrics from kubernetes cluster. Defaults to current date time",
          "format": "date-time",
          "type": "string"
        },
        "usages": {
          "description": "Last uploaded date for usages from kubernetes cluster. Defaults to current date time",
          "format": "date-time",
          "type": "string"
        }
      },
      "type": "object"
    }
  }
}