{
  "id": "https://schema.management.azure.com/schemas/2021-08-08/Microsoft.AlertsManagement.json#",
  "title": "Microsoft.AlertsManagement",
  "description": "Microsoft AlertsManagement Resource Types",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "resourceDefinitions": {
    "actionRules": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2021-08-08"
          ]
        },
        "name": {
          "type": "string",
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.AlertsManagement/actionRules"
          ]
        },
        "location": {
          "type": "string",
          "description": "Resource location"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/AlertProcessingRuleProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Alert processing rule properties."
        },
        "tags": {
          "oneOf": [
            {
              "$ref": "#/definitions/ManagedResourceTags"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Resource tags"
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "location",
        "properties"
      ],
      "description": "Microsoft.AlertsManagement/actionRules"
    }
  },
  "definitions": {
    "Action": {
      "allOf": [
        {
          "type": "object",
          "properties": {
            "actionType": {
              "type": "string",
              "enum": [
                "AddActionGroups",
                "RemoveAllActionGroups"
              ]
            }
          },
          "required": [
            "actionType"
          ],
          "additionalProperties": false
        },
        {
          "oneOf": [
            {
              "allOf": [
                {
                  "$ref": "#/definitions/AddActionGroups"
                },
                {
                  "type": "object",
                  "properties": {
                    "actionType": {
                      "const": "AddActionGroups"
                    }
                  },
                  "required": [
                    "actionType"
                  ]
                }
              ]
            },
            {
              "allOf": [
                {
                  "$ref": "#/definitions/RemoveAllActionGroups"
                },
                {
                  "type": "object",
                  "properties": {
                    "actionType": {
                      "const": "RemoveAllActionGroups"
                    }
                  },
                  "required": [
                    "actionType"
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "AddActionGroups": {
      "type": "object",
      "properties": {
        "actionGroupIds": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "List of action group Ids to add to alert processing rule."
        },
        "actionType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "AddActionGroups"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Action that should be applied."
        }
      },
      "required": [
        "actionGroupIds",
        "actionType"
      ]
    },
    "AlertProcessingRuleProperties": {
      "type": "object",
      "properties": {
        "actions": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Action"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Actions to be applied."
        },
        "conditions": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Condition"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Conditions on which alerts will be filtered."
        },
        "description": {
          "type": "string",
          "description": "Description of alert processing rule."
        },
        "enabled": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Indicates if the given alert processing rule is enabled or disabled."
        },
        "schedule": {
          "oneOf": [
            {
              "$ref": "#/definitions/Schedule"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Scheduling for alert processing rule."
        },
        "scopes": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Scopes on which alert processing rule will apply."
        }
      },
      "required": [
        "actions",
        "scopes"
      ]
    },
    "Condition": {
      "type": "object",
      "properties": {
        "field": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Severity",
                "MonitorService",
                "MonitorCondition",
                "SignalType",
                "TargetResourceType",
                "TargetResource",
                "TargetResourceGroup",
                "AlertRuleId",
                "AlertRuleName",
                "Description",
                "AlertContext"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Field for a given condition."
        },
        "operator": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Equals",
                "NotEquals",
                "Contains",
                "DoesNotContain"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Operator for a given condition."
        },
        "values": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "List of values to match for a given condition."
        }
      }
    },
    "DailyRecurrence": {
      "type": "object",
      "properties": {
        "recurrenceType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Daily"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Specifies when the recurrence should be applied."
        }
      },
      "required": [
        "recurrenceType"
      ]
    },
    "ManagedResourceTags": {
      "type": "object",
      "properties": {},
      "additionalProperties": {
        "type": "string"
      }
    },
    "MonthlyRecurrence": {
      "type": "object",
      "properties": {
        "daysOfMonth": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "integer"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Specifies the values for monthly recurrence pattern."
        },
        "recurrenceType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Monthly"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Specifies when the recurrence should be applied."
        }
      },
      "required": [
        "daysOfMonth",
        "recurrenceType"
      ]
    },
    "Recurrence": {
      "allOf": [
        {
          "type": "object",
          "properties": {
            "endTime": {
              "type": "string",
              "description": "End time for recurrence."
            },
            "startTime": {
              "type": "string",
              "description": "Start time for recurrence."
            },
            "recurrenceType": {
              "type": "string",
              "enum": [
                "Daily",
                "Monthly",
                "Weekly"
              ]
            }
          },
          "required": [
            "recurrenceType"
          ],
          "additionalProperties": false
        },
        {
          "oneOf": [
            {
              "allOf": [
                {
                  "$ref": "#/definitions/DailyRecurrence"
                },
                {
                  "type": "object",
                  "properties": {
                    "recurrenceType": {
                      "const": "Daily"
                    }
                  },
                  "required": [
                    "recurrenceType"
                  ]
                }
              ]
            },
            {
              "allOf": [
                {
                  "$ref": "#/definitions/MonthlyRecurrence"
                },
                {
                  "type": "object",
                  "properties": {
                    "recurrenceType": {
                      "const": "Monthly"
                    }
                  },
                  "required": [
                    "recurrenceType"
                  ]
                }
              ]
            },
            {
              "allOf": [
                {
                  "$ref": "#/definitions/WeeklyRecurrence"
                },
                {
                  "type": "object",
                  "properties": {
                    "recurrenceType": {
                      "const": "Weekly"
                    }
                  },
                  "required": [
                    "recurrenceType"
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "RemoveAllActionGroups": {
      "type": "object",
      "properties": {
        "actionType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "RemoveAllActionGroups"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Action that should be applied."
        }
      },
      "required": [
        "actionType"
      ]
    },
    "Schedule": {
      "type": "object",
      "properties": {
        "effectiveFrom": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^(?:(\\d{4}-\\d{2}-\\d{2})T(\\d{2}:\\d{2}:\\d{2}(?:\\.\\d+)?))$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Scheduling effective from time. Date-Time in ISO-8601 format without timezone suffix."
        },
        "effectiveUntil": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^(?:(\\d{4}-\\d{2}-\\d{2})T(\\d{2}:\\d{2}:\\d{2}(?:\\.\\d+)?))$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Scheduling effective until time. Date-Time in ISO-8601 format without timezone suffix."
        },
        "recurrences": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Recurrence"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "List of recurrences."
        },
        "timeZone": {
          "type": "string",
          "description": "Scheduling time zone."
        }
      }
    },
    "WeeklyRecurrence": {
      "type": "object",
      "properties": {
        "daysOfWeek": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "Sunday",
                  "Monday",
                  "Tuesday",
                  "Wednesday",
                  "Thursday",
                  "Friday",
                  "Saturday"
                ]
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Specifies the values for weekly recurrence pattern."
        },
        "recurrenceType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Weekly"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Specifies when the recurrence should be applied."
        }
      },
      "required": [
        "daysOfWeek",
        "recurrenceType"
      ]
    }
  }
}