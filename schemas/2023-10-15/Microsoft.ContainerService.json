{
  "id": "https://schema.management.azure.com/schemas/2023-10-15/Microsoft.ContainerService.json#",
  "title": "Microsoft.ContainerService",
  "description": "Microsoft ContainerService Resource Types",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "resourceDefinitions": {
    "fleets_members": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2023-10-15"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$",
              "minLength": 1,
              "maxLength": 50
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.ContainerService/fleets/members"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/FleetMemberProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource-specific properties for this resource."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.ContainerService/fleets/members"
    },
    "fleets_updateRuns": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2023-10-15"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$",
              "minLength": 1,
              "maxLength": 50
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.ContainerService/fleets/updateRuns"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/UpdateRunProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource-specific properties for this resource."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.ContainerService/fleets/updateRuns"
    },
    "fleets_updateStrategies": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2023-10-15"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$",
              "minLength": 1,
              "maxLength": 50
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.ContainerService/fleets/updateStrategies"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/FleetUpdateStrategyProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource-specific properties for this resource."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.ContainerService/fleets/updateStrategies"
    },
    "fleets": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2023-10-15"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$",
              "minLength": 1,
              "maxLength": 63
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.ContainerService/fleets"
          ]
        },
        "identity": {
          "oneOf": [
            {
              "$ref": "#/definitions/ManagedServiceIdentity"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Managed identity."
        },
        "location": {
          "type": "string",
          "description": "The geo-location where the resource lives"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/FleetProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource-specific properties for this resource."
        },
        "tags": {
          "oneOf": [
            {
              "$ref": "#/definitions/TrackedResourceTags"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Resource tags."
        },
        "resources": {
          "type": "array",
          "items": {
            "oneOf": [
              {
                "$ref": "#/definitions/fleets_members_childResource"
              },
              {
                "$ref": "#/definitions/fleets_updateRuns_childResource"
              },
              {
                "$ref": "#/definitions/fleets_updateStrategies_childResource"
              }
            ]
          }
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "location",
        "properties"
      ],
      "description": "Microsoft.ContainerService/fleets"
    }
  },
  "definitions": {
    "FleetMemberProperties": {
      "type": "object",
      "properties": {
        "clusterResourceId": {
          "type": "string",
          "description": "The ARM resource id of the cluster that joins the Fleet. Must be a valid Azure resource id. e.g.: '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ContainerService/managedClusters/{clusterName}'."
        },
        "group": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$",
              "minLength": 1,
              "maxLength": 50
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The group this member belongs to for multi-cluster update management."
        }
      },
      "required": [
        "clusterResourceId"
      ]
    },
    "FleetProperties": {
      "type": "object",
      "properties": {}
    },
    "FleetUpdateStrategyProperties": {
      "type": "object",
      "properties": {
        "strategy": {
          "oneOf": [
            {
              "$ref": "#/definitions/UpdateRunStrategy"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Defines the update sequence of the clusters."
        }
      },
      "required": [
        "strategy"
      ]
    },
    "ManagedClusterUpdate": {
      "type": "object",
      "properties": {
        "nodeImageSelection": {
          "oneOf": [
            {
              "$ref": "#/definitions/NodeImageSelection"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The node image upgrade to be applied to the target nodes in update run."
        },
        "upgrade": {
          "oneOf": [
            {
              "$ref": "#/definitions/ManagedClusterUpgradeSpec"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The upgrade to apply to the ManagedClusters."
        }
      },
      "required": [
        "upgrade"
      ]
    },
    "ManagedClusterUpgradeSpec": {
      "type": "object",
      "properties": {
        "kubernetesVersion": {
          "type": "string",
          "description": "The Kubernetes version to upgrade the member clusters to."
        },
        "type": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Full",
                "NodeImageOnly"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "ManagedClusterUpgradeType is the type of upgrade to be applied."
        }
      },
      "required": [
        "type"
      ]
    },
    "ManagedServiceIdentity": {
      "type": "object",
      "properties": {
        "type": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "None",
                "SystemAssigned",
                "UserAssigned",
                "SystemAssigned, UserAssigned"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Type of managed service identity (where both SystemAssigned and UserAssigned types are allowed)."
        },
        "userAssignedIdentities": {
          "oneOf": [
            {
              "$ref": "#/definitions/UserAssignedIdentities"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The set of user assigned identities associated with the resource. The userAssignedIdentities dictionary keys will be ARM resource ids in the form: '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ManagedIdentity/userAssignedIdentities/{identityName}. The dictionary values can be empty objects ({}) in requests."
        }
      },
      "required": [
        "type"
      ]
    },
    "NodeImageSelection": {
      "type": "object",
      "properties": {
        "type": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Latest",
                "Consistent"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The node image upgrade type."
        }
      },
      "required": [
        "type"
      ]
    },
    "TrackedResourceTags": {
      "type": "object",
      "properties": {},
      "additionalProperties": {
        "type": "string"
      }
    },
    "UpdateGroup": {
      "type": "object",
      "properties": {
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$",
              "minLength": 1,
              "maxLength": 50
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Name of the group.\nIt must match a group name of an existing fleet member."
        }
      },
      "required": [
        "name"
      ]
    },
    "UpdateRunProperties": {
      "type": "object",
      "properties": {
        "managedClusterUpdate": {
          "oneOf": [
            {
              "$ref": "#/definitions/ManagedClusterUpdate"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The update to be applied to all clusters in the UpdateRun. The managedClusterUpdate can be modified until the run is started."
        },
        "strategy": {
          "oneOf": [
            {
              "$ref": "#/definitions/UpdateRunStrategy"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The strategy defines the order in which the clusters will be updated.\nIf not set, all members will be updated sequentially. The UpdateRun status will show a single UpdateStage and a single UpdateGroup targeting all members.\nThe strategy of the UpdateRun can be modified until the run is started."
        },
        "updateStrategyId": {
          "type": "string",
          "description": "The resource id of the FleetUpdateStrategy resource to reference.\n\nWhen creating a new run, there are three ways to define a strategy for the run:\n1. Define a new strategy in place: Set the \"strategy\" field.\n2. Use an existing strategy: Set the \"updateStrategyId\" field. (since 2023-08-15-preview)\n3. Use the default strategy to update all the members one by one: Leave both \"updateStrategyId\" and \"strategy\" unset. (since 2023-08-15-preview)\n\nSetting both \"updateStrategyId\" and \"strategy\" is invalid.\n\nUpdateRuns created by \"updateStrategyId\" snapshot the referenced UpdateStrategy at the time of creation and store it in the \"strategy\" field. \nSubsequent changes to the referenced FleetUpdateStrategy resource do not propagate.\nUpdateRunStrategy changes can be made directly on the \"strategy\" field before launching the UpdateRun."
        }
      },
      "required": [
        "managedClusterUpdate"
      ]
    },
    "UpdateRunStrategy": {
      "type": "object",
      "properties": {
        "stages": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/UpdateStage"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The list of stages that compose this update run. Min size: 1."
        }
      },
      "required": [
        "stages"
      ]
    },
    "UpdateStage": {
      "type": "object",
      "properties": {
        "afterStageWaitInSeconds": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The time in seconds to wait at the end of this stage before starting the next one. Defaults to 0 seconds if unspecified."
        },
        "groups": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/UpdateGroup"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Defines the groups to be executed in parallel in this stage. Duplicate groups are not allowed. Min size: 1."
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$",
              "minLength": 1,
              "maxLength": 50
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The name of the stage. Must be unique within the UpdateRun."
        }
      },
      "required": [
        "name"
      ]
    },
    "UserAssignedIdentities": {
      "type": "object",
      "properties": {},
      "additionalProperties": {
        "$ref": "#/definitions/UserAssignedIdentity"
      }
    },
    "UserAssignedIdentity": {
      "type": "object",
      "properties": {}
    },
    "fleets_members_childResource": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2023-10-15"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$",
              "minLength": 1,
              "maxLength": 50
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "members"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/FleetMemberProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource-specific properties for this resource."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.ContainerService/fleets/members"
    },
    "fleets_updateRuns_childResource": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2023-10-15"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$",
              "minLength": 1,
              "maxLength": 50
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "updateRuns"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/UpdateRunProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource-specific properties for this resource."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.ContainerService/fleets/updateRuns"
    },
    "fleets_updateStrategies_childResource": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2023-10-15"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$",
              "minLength": 1,
              "maxLength": 50
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "updateStrategies"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/FleetUpdateStrategyProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource-specific properties for this resource."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.ContainerService/fleets/updateStrategies"
    }
  }
}