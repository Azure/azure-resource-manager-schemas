{
  "id": "https://schema.management.azure.com/schemas/2024-05-01-preview/Microsoft.Impact.json#",
  "title": "Microsoft.Impact",
  "description": "Microsoft Impact Resource Types",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "subscription_resourceDefinitions": {
    "connectors": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-05-01-preview"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-zA-Z0-9-]{3,24}$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.Impact/connectors"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/ConnectorProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource-specific properties for this resource."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.Impact/connectors"
    },
    "workloadImpacts_insights": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-05-01-preview"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-zA-Z0-9][a-zA-Z0-9.]*[a-zA-Z0-9]{3,180}$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.Impact/workloadImpacts/insights"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/InsightProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource-specific properties for this resource."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.Impact/workloadImpacts/insights"
    },
    "workloadImpacts": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-05-01-preview"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-zA-Z0-9][a-zA-Z0-9-:]*[a-zA-Z0-9]{3,120}$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.Impact/workloadImpacts"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/WorkloadImpactProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource-specific properties for this resource."
        },
        "resources": {
          "type": "array",
          "items": {
            "oneOf": [
              {
                "$ref": "#/definitions/workloadImpacts_insights_childResource"
              }
            ]
          }
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.Impact/workloadImpacts"
    }
  },
  "unknown_resourceDefinitions": {
    "impactCategories": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-05-01-preview"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-zA-Z0-9][a-zA-Z0-9.]*[a-zA-Z0-9]{3,180}$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.Impact/impactCategories"
          ]
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type"
      ],
      "description": "Microsoft.Impact/impactCategories"
    }
  },
  "definitions": {
    "ClientIncidentDetails": {
      "type": "object",
      "properties": {
        "clientIncidentId": {
          "type": "string",
          "description": "Client incident id. ex : id of the incident created to investigate and address the impact if any."
        },
        "clientIncidentSource": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "AzureDevops",
                "ICM",
                "Jira",
                "ServiceNow",
                "Other"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Client incident source. ex : source system name where the incident is created"
        }
      }
    },
    "Connectivity": {
      "type": "object",
      "properties": {
        "port": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Port number for the connection"
        },
        "protocol": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "TCP",
                "UDP",
                "HTTP",
                "HTTPS",
                "RDP",
                "FTP",
                "SSH",
                "Other"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Protocol used for the connection"
        },
        "source": {
          "oneOf": [
            {
              "$ref": "#/definitions/SourceOrTarget"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Source from which the connection was attempted"
        },
        "target": {
          "oneOf": [
            {
              "$ref": "#/definitions/SourceOrTarget"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "target which connection was attempted"
        }
      }
    },
    "ConnectorProperties": {
      "type": "object",
      "properties": {
        "connectorType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "AzureMonitor"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "connector type"
        }
      },
      "required": [
        "connectorType"
      ]
    },
    "Content": {
      "type": "object",
      "properties": {
        "description": {
          "type": "string",
          "description": "Description of the insight"
        },
        "title": {
          "type": "string",
          "description": "Title of the insight"
        }
      },
      "required": [
        "description",
        "title"
      ]
    },
    "ErrorDetailProperties": {
      "type": "object",
      "properties": {
        "errorCode": {
          "type": "string",
          "description": "ARM Error code associated with the impact."
        },
        "errorMessage": {
          "type": "string",
          "description": "ARM Error Message associated with the impact"
        }
      }
    },
    "ExpectedValueRange": {
      "type": "object",
      "properties": {
        "max": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Max threshold value for the metric"
        },
        "min": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Min threshold value for the metric"
        }
      },
      "required": [
        "max",
        "min"
      ]
    },
    "ImpactDetails": {
      "type": "object",
      "properties": {
        "endTime": {
          "type": "string",
          "description": "Time at which impact was ended according to reported impact."
        },
        "impactedResourceId": {
          "type": "string",
          "description": "List of impacted Azure resources."
        },
        "impactId": {
          "type": "string",
          "description": "Azure Id of the impact."
        },
        "startTime": {
          "type": "string",
          "description": "Time at which impact was started according to reported impact."
        }
      },
      "required": [
        "impactedResourceId",
        "impactId",
        "startTime"
      ]
    },
    "InsightProperties": {
      "type": "object",
      "properties": {
        "additionalDetails": {
          "oneOf": [
            {},
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "additional details of the insight."
        },
        "category": {
          "type": "string",
          "description": "category of the insight."
        },
        "content": {
          "oneOf": [
            {
              "$ref": "#/definitions/Content"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Contains title & description for the insight"
        },
        "eventId": {
          "type": "string",
          "description": "Identifier of the event that has been correlated with this insight. This can be used to aggregate insights for the same event."
        },
        "eventTime": {
          "type": "string",
          "description": "Time of the event, which has been correlated the impact."
        },
        "groupId": {
          "type": "string",
          "description": "Identifier that can be used to group similar insights."
        },
        "impact": {
          "oneOf": [
            {
              "$ref": "#/definitions/ImpactDetails"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "details of of the impact for which insight has been generated."
        },
        "insightUniqueId": {
          "type": "string",
          "description": "unique id of the insight."
        },
        "status": {
          "type": "string",
          "description": "status of the insight. example resolved, repaired, other."
        }
      },
      "required": [
        "category",
        "content",
        "impact",
        "insightUniqueId"
      ]
    },
    "Performance": {
      "type": "object",
      "properties": {
        "actual": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Observed value for the metric"
        },
        "expected": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Threshold value for the metric"
        },
        "expectedValueRange": {
          "oneOf": [
            {
              "$ref": "#/definitions/ExpectedValueRange"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Max and Min Threshold values for the metric"
        },
        "metricName": {
          "type": "string",
          "description": "Name of the Metric examples:  Disk, IOPs, CPU, GPU, Memory, details can be found from /impactCategories API"
        },
        "unit": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "ByteSeconds",
                "Bytes",
                "BytesPerSecond",
                "Cores",
                "Count",
                "CountPerSecond",
                "MilliCores",
                "MilliSeconds",
                "NanoCores",
                "Percent",
                "Seconds",
                "Other"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Unit of the metric ex: Bytes, Percentage, Count, Seconds, Milliseconds, Bytes/Second, Count/Second, etc.., Other"
        }
      }
    },
    "SourceOrTarget": {
      "type": "object",
      "properties": {
        "azureResourceId": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "(\\/[0-9a-zA-Z]+)*"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Azure resource id, example /subscription/{subscription}/resourceGroup/{rg}/Microsoft.compute/virtualMachine/{vmName}"
        }
      }
    },
    "Workload": {
      "type": "object",
      "properties": {
        "context": {
          "type": "string",
          "description": "the scenario for the workload"
        },
        "toolset": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Terraform",
                "Puppet",
                "Chef",
                "SDK",
                "Ansible",
                "ARM",
                "Portal",
                "Shell",
                "Other"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Tool used to interact with Azure. SDK, AzPortal, etc.., Other"
        }
      }
    },
    "WorkloadImpactProperties": {
      "type": "object",
      "properties": {
        "additionalProperties": {
          "oneOf": [
            {
              "$ref": "#/definitions/WorkloadImpactPropertiesAdditionalProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Additional fields related to impact, applicable fields per resource type are list under /impactCategories API"
        },
        "armCorrelationIds": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The ARM correlation ids, this is important field for control plane related impacts"
        },
        "clientIncidentDetails": {
          "oneOf": [
            {
              "$ref": "#/definitions/ClientIncidentDetails"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Client incident details ex: incidentId , incident source"
        },
        "confidenceLevel": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Low",
                "Medium",
                "High"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Degree of confidence on the impact being a platform issue"
        },
        "connectivity": {
          "oneOf": [
            {
              "$ref": "#/definitions/Connectivity"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Details about connectivity issue. Applicable when root resource causing the issue is not identified. For example, when a VM is impacted due to a network issue, the impacted resource is identified as the VM, but the root cause is the network. In such cases, the connectivity field will have the details about the network issue"
        },
        "endDateTime": {
          "type": "string",
          "description": "Time at which impact has ended"
        },
        "errorDetails": {
          "oneOf": [
            {
              "$ref": "#/definitions/ErrorDetailProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "ARM error code and error message associated with the impact"
        },
        "impactCategory": {
          "type": "string",
          "description": "Category of the impact,  details can found from /impactCategories API"
        },
        "impactDescription": {
          "type": "string",
          "description": "A detailed description of the impact"
        },
        "impactedResourceId": {
          "type": "string",
          "description": "Azure resource id of the impacted resource"
        },
        "impactGroupId": {
          "type": "string",
          "description": "Use this field to group impacts"
        },
        "performance": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Performance"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Details about performance issue. Applicable for performance impacts."
        },
        "startDateTime": {
          "type": "string",
          "description": "Time at which impact was observed"
        },
        "workload": {
          "oneOf": [
            {
              "$ref": "#/definitions/Workload"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Information about the impacted workload"
        }
      },
      "required": [
        "impactCategory",
        "impactedResourceId",
        "startDateTime"
      ]
    },
    "WorkloadImpactPropertiesAdditionalProperties": {
      "type": "object",
      "properties": {},
      "additionalProperties": {}
    },
    "workloadImpacts_insights_childResource": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-05-01-preview"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-zA-Z0-9][a-zA-Z0-9.]*[a-zA-Z0-9]{3,180}$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "insights"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/InsightProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource-specific properties for this resource."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.Impact/workloadImpacts/insights"
    }
  }
}