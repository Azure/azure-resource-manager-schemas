{
  "id": "https://schema.management.azure.com/schemas/2024-08-01/Microsoft.Security.json#",
  "title": "Microsoft.Security",
  "description": "Microsoft Security Resource Types",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "tenant_resourceDefinitions": {
    "customRecommendations": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-08-01"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "[{]?[0-9a-fA-F]{8}-(?:[0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.Security/customRecommendations"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/CustomRecommendationProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "describes Custom Recommendation properties."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.Security/customRecommendations"
    },
    "securityStandards": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-08-01"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "[{]?[0-9a-fA-F]{8}-(?:[0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.Security/securityStandards"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/StandardProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Properties of a security standard"
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.Security/securityStandards"
    },
    "standardAssignments": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-08-01"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "[{]?[0-9a-fA-F]{8}-(?:[0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.Security/standardAssignments"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/StandardAssignmentProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Properties of a standard assignments assignment"
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.Security/standardAssignments"
    }
  },
  "managementGroup_resourceDefinitions": {
    "customRecommendations": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-08-01"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "[{]?[0-9a-fA-F]{8}-(?:[0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.Security/customRecommendations"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/CustomRecommendationProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "describes Custom Recommendation properties."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.Security/customRecommendations"
    },
    "securityStandards": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-08-01"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "[{]?[0-9a-fA-F]{8}-(?:[0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.Security/securityStandards"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/StandardProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Properties of a security standard"
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.Security/securityStandards"
    },
    "standardAssignments": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-08-01"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "[{]?[0-9a-fA-F]{8}-(?:[0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.Security/standardAssignments"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/StandardAssignmentProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Properties of a standard assignments assignment"
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.Security/standardAssignments"
    }
  },
  "subscription_resourceDefinitions": {
    "customRecommendations": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-08-01"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "[{]?[0-9a-fA-F]{8}-(?:[0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.Security/customRecommendations"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/CustomRecommendationProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "describes Custom Recommendation properties."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.Security/customRecommendations"
    },
    "securityStandards": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-08-01"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "[{]?[0-9a-fA-F]{8}-(?:[0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.Security/securityStandards"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/StandardProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Properties of a security standard"
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.Security/securityStandards"
    },
    "standardAssignments": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-08-01"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "[{]?[0-9a-fA-F]{8}-(?:[0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.Security/standardAssignments"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/StandardAssignmentProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Properties of a standard assignments assignment"
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.Security/standardAssignments"
    }
  },
  "resourceDefinitions": {
    "customRecommendations": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-08-01"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "[{]?[0-9a-fA-F]{8}-(?:[0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.Security/customRecommendations"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/CustomRecommendationProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "describes Custom Recommendation properties."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.Security/customRecommendations"
    },
    "securityStandards": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-08-01"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "[{]?[0-9a-fA-F]{8}-(?:[0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.Security/securityStandards"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/StandardProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Properties of a security standard"
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.Security/securityStandards"
    },
    "standardAssignments": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-08-01"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "[{]?[0-9a-fA-F]{8}-(?:[0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.Security/standardAssignments"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/StandardAssignmentProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Properties of a standard assignments assignment"
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.Security/standardAssignments"
    }
  },
  "definitions": {
    "AssignedAssessmentItem": {
      "type": "object",
      "properties": {
        "assessmentKey": {
          "type": "string",
          "description": "Unique key to a security assessment object"
        }
      }
    },
    "AssignedStandardItem": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "Full resourceId of the Microsoft.Security/standard object"
        }
      }
    },
    "AttestationEvidence": {
      "type": "object",
      "properties": {
        "description": {
          "type": "string",
          "description": "The description of the evidence"
        },
        "sourceUrl": {
          "type": "string",
          "description": "The source url of the evidence"
        }
      }
    },
    "CustomRecommendationProperties": {
      "type": "object",
      "properties": {
        "cloudProviders": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "Azure",
                  "AWS",
                  "GCP"
                ]
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "List of all standard supported clouds."
        },
        "description": {
          "type": "string",
          "description": "The description to relate to the assessments generated by this Recommendation."
        },
        "displayName": {
          "type": "string",
          "description": "The display name of the assessments generated by this Recommendation."
        },
        "query": {
          "type": "string",
          "description": "KQL query representing the Recommendation results required."
        },
        "remediationDescription": {
          "type": "string",
          "description": "The remediation description to relate to the assessments generated by this Recommendation."
        },
        "securityIssue": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Vulnerability",
                "ExcessivePermissions",
                "AnonymousAccess",
                "NetworkExposure",
                "TrafficEncryption",
                "BestPractices"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The severity to relate to the assessments generated by this Recommendation."
        },
        "severity": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "High",
                "Medium",
                "Low"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The severity to relate to the assessments generated by this Recommendation."
        }
      }
    },
    "PartialAssessmentProperties": {
      "type": "object",
      "properties": {
        "assessmentKey": {
          "type": "string",
          "description": "The assessment key"
        }
      }
    },
    "StandardAssignmentMetadata": {
      "type": "object",
      "properties": {}
    },
    "StandardAssignmentProperties": {
      "type": "object",
      "properties": {
        "assignedStandard": {
          "oneOf": [
            {
              "$ref": "#/definitions/AssignedStandardItem"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Standard item with key as applied to this standard assignment over the given scope"
        },
        "attestationData": {
          "oneOf": [
            {
              "$ref": "#/definitions/StandardAssignmentPropertiesAttestationData"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Additional data about assignment that has Attest effect"
        },
        "description": {
          "type": "string",
          "description": "Description of the standardAssignment"
        },
        "displayName": {
          "type": "string",
          "description": "Display name of the standardAssignment"
        },
        "effect": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "Audit",
                "Exempt",
                "Attest"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Expected effect of this assignment (Audit/Exempt/Attest)"
        },
        "excludedScopes": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Excluded scopes, filter out the descendants of the scope (on management scopes)"
        },
        "exemptionData": {
          "oneOf": [
            {
              "$ref": "#/definitions/StandardAssignmentPropertiesExemptionData"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Additional data about assignment that has Exempt effect"
        },
        "expiresOn": {
          "type": "string",
          "description": "Expiration date of this assignment as a full ISO date"
        },
        "metadata": {
          "oneOf": [
            {
              "$ref": "#/definitions/StandardAssignmentMetadata"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The standard assignment metadata."
        }
      }
    },
    "StandardAssignmentPropertiesAttestationData": {
      "type": "object",
      "properties": {
        "assignedAssessment": {
          "oneOf": [
            {
              "$ref": "#/definitions/AssignedAssessmentItem"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Component item with key as applied to this standard assignment over the given scope"
        },
        "complianceState": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "unknown",
                "compliant",
                "nonCompliant"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Attest category of this assignment"
        },
        "evidence": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/AttestationEvidence"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Array of links to attestation evidence"
        }
      }
    },
    "StandardAssignmentPropertiesExemptionData": {
      "type": "object",
      "properties": {
        "assignedAssessment": {
          "oneOf": [
            {
              "$ref": "#/definitions/AssignedAssessmentItem"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Component item with key as applied to this standard assignment over the given scope"
        },
        "exemptionCategory": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "waiver",
                "mitigated"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Exemption category of this assignment"
        }
      }
    },
    "StandardMetadata": {
      "type": "object",
      "properties": {}
    },
    "StandardProperties": {
      "type": "object",
      "properties": {
        "assessments": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/PartialAssessmentProperties"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "List of assessment keys to apply to standard scope."
        },
        "cloudProviders": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "Azure",
                  "AWS",
                  "GCP"
                ]
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "List of all standard supported clouds."
        },
        "description": {
          "type": "string",
          "description": "Description of the standard"
        },
        "displayName": {
          "type": "string",
          "description": "Display name of the standard, equivalent to the standardId"
        },
        "metadata": {
          "oneOf": [
            {
              "$ref": "#/definitions/StandardMetadata"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The security standard metadata."
        },
        "policySetDefinitionId": {
          "type": "string",
          "description": "The policy set definition id associated with the standard."
        }
      }
    }
  }
}