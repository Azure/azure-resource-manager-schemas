{
  "id": "https://schema.management.azure.com/schemas/2024-10-01-preview/Microsoft.DatabaseWatcher.json#",
  "title": "Microsoft.DatabaseWatcher",
  "description": "Microsoft DatabaseWatcher Resource Types",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "resourceDefinitions": {
    "watchers_alertRuleResources": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-10-01-preview"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-zA-Z0-9]{1}[a-zA-Z0-9-_.]{0,62}[a-zA-Z0-9_]{1}$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.DatabaseWatcher/watchers/alertRuleResources"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/AlertRuleResourceProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource-specific properties for this resource."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.DatabaseWatcher/watchers/alertRuleResources"
    },
    "watchers_sharedPrivateLinkResources": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-10-01-preview"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-zA-Z0-9]{1}[a-zA-Z0-9-_.]{0,62}[a-zA-Z0-9_]{1}$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.DatabaseWatcher/watchers/sharedPrivateLinkResources"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/SharedPrivateLinkResourceProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource-specific properties for this resource."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.DatabaseWatcher/watchers/sharedPrivateLinkResources"
    },
    "watchers_targets": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-10-01-preview"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-zA-Z0-9]{1}[a-zA-Z0-9-_]{3,60}$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.DatabaseWatcher/watchers/targets"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/TargetProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource-specific properties for this resource."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.DatabaseWatcher/watchers/targets"
    },
    "watchers": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-10-01-preview"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-zA-Z0-9]{1}[a-zA-Z0-9-_]{3,60}$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.DatabaseWatcher/watchers"
          ]
        },
        "identity": {
          "oneOf": [
            {
              "$ref": "#/definitions/ManagedServiceIdentity"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The managed service identities assigned to this resource."
        },
        "location": {
          "type": "string",
          "description": "The geo-location where the resource lives"
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/WatcherProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource-specific properties for this resource."
        },
        "tags": {
          "oneOf": [
            {
              "$ref": "#/definitions/TrackedResourceTags"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Resource tags."
        },
        "resources": {
          "type": "array",
          "items": {
            "oneOf": [
              {
                "$ref": "#/definitions/watchers_alertRuleResources_childResource"
              },
              {
                "$ref": "#/definitions/watchers_healthValidations_childResource"
              },
              {
                "$ref": "#/definitions/watchers_sharedPrivateLinkResources_childResource"
              },
              {
                "$ref": "#/definitions/watchers_targets_childResource"
              }
            ]
          }
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "location",
        "properties"
      ],
      "description": "Microsoft.DatabaseWatcher/watchers"
    }
  },
  "unknown_resourceDefinitions": {
    "watchers_healthValidations": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-10-01-preview"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-zA-Z0-9]{1}[a-zA-Z0-9-_.]{0,62}[a-zA-Z0-9_]{1}$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.DatabaseWatcher/watchers/healthValidations"
          ]
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type"
      ],
      "description": "Microsoft.DatabaseWatcher/watchers/healthValidations"
    }
  },
  "definitions": {
    "AlertRuleResourceProperties": {
      "type": "object",
      "properties": {
        "alertRuleResourceId": {
          "type": "string",
          "description": "The resource ID of the alert rule resource."
        },
        "alertRuleTemplateId": {
          "type": "string",
          "description": "The template ID associated with alert rule resource."
        },
        "alertRuleTemplateVersion": {
          "type": "string",
          "description": "The alert rule template version."
        },
        "createdWithProperties": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "CreatedWithActionGroup",
                "None"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The properties with which the alert rule resource was created."
        },
        "creationTime": {
          "type": "string",
          "description": "The creation time of the alert rule resource."
        }
      },
      "required": [
        "alertRuleResourceId",
        "alertRuleTemplateId",
        "alertRuleTemplateVersion",
        "createdWithProperties",
        "creationTime"
      ]
    },
    "Datastore": {
      "type": "object",
      "properties": {
        "adxClusterResourceId": {
          "type": "string",
          "description": "The Azure resource ID of an Azure Data Explorer cluster."
        },
        "kustoClusterDisplayName": {
          "type": "string",
          "description": "The Kusto cluster display name."
        },
        "kustoClusterUri": {
          "type": "string",
          "description": "The Kusto cluster URI."
        },
        "kustoDatabaseName": {
          "type": "string",
          "description": "The name of a Kusto database."
        },
        "kustoDataIngestionUri": {
          "type": "string",
          "description": "The Kusto data ingestion URI."
        },
        "kustoManagementUrl": {
          "type": "string",
          "description": "The Kusto management URL."
        },
        "kustoOfferingType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "adx",
                "free",
                "fabric"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The type of a Kusto offering."
        }
      },
      "required": [
        "kustoClusterUri",
        "kustoDatabaseName",
        "kustoDataIngestionUri",
        "kustoManagementUrl",
        "kustoOfferingType"
      ]
    },
    "ManagedServiceIdentity": {
      "type": "object",
      "properties": {
        "type": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "None",
                "SystemAssigned",
                "UserAssigned",
                "SystemAssigned, UserAssigned"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Type of managed service identity (where both SystemAssigned and UserAssigned types are allowed)."
        },
        "userAssignedIdentities": {
          "oneOf": [
            {
              "$ref": "#/definitions/UserAssignedIdentities"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The set of user assigned identities associated with the resource. The userAssignedIdentities dictionary keys will be ARM resource ids in the form: '/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ManagedIdentity/userAssignedIdentities/{identityName}. The dictionary values can be empty objects ({}) in requests."
        }
      },
      "required": [
        "type"
      ]
    },
    "SharedPrivateLinkResourceProperties": {
      "type": "object",
      "properties": {
        "dnsZone": {
          "type": "string",
          "description": "The DNS zone segment to be included in the DNS name of the shared private link. Value is required for Azure Data Explorer clusters and SQL managed instances, and must be omitted for SQL logical servers and key vaults. The value is the second segment of the host FQDN name of the resource that the shared private link resource is for. For example: if the host name is 'adx-cluster-21187695.eastus.kusto.windows.net', then the value is 'eastus'; if the host name is 'sql-mi-23961134.767d5869f605.database.windows.net', then the value is '767d5869f605'."
        },
        "groupId": {
          "type": "string",
          "description": "The group id from the provider of resource the shared private link resource is for."
        },
        "privateLinkResourceId": {
          "type": "string",
          "description": "The resource ID of the resource the shared private link resource is for."
        },
        "requestMessage": {
          "type": "string",
          "description": "The request message for requesting approval of the shared private link resource."
        }
      },
      "required": [
        "groupId",
        "privateLinkResourceId",
        "requestMessage"
      ]
    },
    "SqlDbElasticPoolTargetProperties": {
      "type": "object",
      "properties": {
        "anchorDatabaseResourceId": {
          "type": "string",
          "description": "The Azure resource ID of the anchor database used to connect to an elastic pool."
        },
        "readIntent": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Set to true to monitor a high availability replica of specified target, if any."
        },
        "sqlEpResourceId": {
          "type": "string",
          "description": "The Azure resource ID of an Azure SQL DB elastic pool target."
        },
        "targetType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "SqlEp"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Discriminator property for TargetProperties."
        }
      },
      "required": [
        "anchorDatabaseResourceId",
        "sqlEpResourceId",
        "targetType"
      ]
    },
    "SqlDbSingleDatabaseTargetProperties": {
      "type": "object",
      "properties": {
        "readIntent": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Set to true to monitor a high availability replica of specified target, if any."
        },
        "sqlDbResourceId": {
          "type": "string",
          "description": "The Azure resource ID of an Azure SQL DB database target."
        },
        "targetType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "SqlDb"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Discriminator property for TargetProperties."
        }
      },
      "required": [
        "sqlDbResourceId",
        "targetType"
      ]
    },
    "SqlMiTargetProperties": {
      "type": "object",
      "properties": {
        "connectionTcpPort": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The TCP port number to optionally use in the connection string when connecting to an Azure SQL Managed Instance target."
        },
        "readIntent": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Set to true to monitor a high availability replica of specified target, if any."
        },
        "sqlMiResourceId": {
          "type": "string",
          "description": "The Azure resource ID of an Azure SQL Managed Instance target."
        },
        "targetType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "SqlMi"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Discriminator property for TargetProperties."
        }
      },
      "required": [
        "sqlMiResourceId",
        "targetType"
      ]
    },
    "SqlVmTargetProperties": {
      "type": "object",
      "properties": {
        "connectionTcpPort": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The TCP port number to optionally use in the connection string when connecting to an Azure SQL VM target."
        },
        "sqlNamedInstanceName": {
          "type": "string",
          "description": "The SQL instance name to optionally use in the connection string when connecting to an Azure SQL VM target."
        },
        "sqlVmResourceId": {
          "type": "string",
          "description": "The Azure resource ID of an Azure SQL VM target."
        },
        "targetType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "SqlVm"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Discriminator property for TargetProperties."
        }
      },
      "required": [
        "sqlVmResourceId",
        "targetType"
      ]
    },
    "TargetProperties": {
      "allOf": [
        {
          "type": "object",
          "properties": {
            "connectionServerName": {
              "oneOf": [
                {
                  "type": "string",
                  "maxLength": 200
                },
                {
                  "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
                }
              ],
              "description": "The FQDN host name of the server to use in the connection string when connecting to a target. For example, for an Azure SQL logical server in the Azure commercial cloud, the value might be 'sql-logical-server-22092780.database.windows.net'; for an Azure SQL managed instance in the Azure commercial cloud, the value might be 'sql-mi-39441134.767d5869f605.database.windows.net'. Port number and instance name must be specified separately."
            },
            "targetAuthenticationType": {
              "oneOf": [
                {
                  "type": "string",
                  "enum": [
                    "Aad",
                    "Sql"
                  ]
                },
                {
                  "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
                }
              ],
              "description": "The type of authentication to use when connecting to a target."
            },
            "targetVault": {
              "oneOf": [
                {
                  "$ref": "#/definitions/VaultSecret"
                },
                {
                  "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
                }
              ],
              "description": "To use SQL authentication when connecting to targets, specify the vault where the login name and password secrets are stored."
            },
            "targetType": {
              "type": "string",
              "enum": [
                "SqlDb",
                "SqlEp",
                "SqlMi",
                "SqlVm"
              ]
            }
          },
          "required": [
            "connectionServerName",
            "targetAuthenticationType",
            "targetType"
          ],
          "additionalProperties": false
        },
        {
          "oneOf": [
            {
              "allOf": [
                {
                  "$ref": "#/definitions/SqlDbSingleDatabaseTargetProperties"
                },
                {
                  "type": "object",
                  "properties": {
                    "targetType": {
                      "const": "SqlDb"
                    }
                  },
                  "required": [
                    "targetType"
                  ]
                }
              ]
            },
            {
              "allOf": [
                {
                  "$ref": "#/definitions/SqlDbElasticPoolTargetProperties"
                },
                {
                  "type": "object",
                  "properties": {
                    "targetType": {
                      "const": "SqlEp"
                    }
                  },
                  "required": [
                    "targetType"
                  ]
                }
              ]
            },
            {
              "allOf": [
                {
                  "$ref": "#/definitions/SqlMiTargetProperties"
                },
                {
                  "type": "object",
                  "properties": {
                    "targetType": {
                      "const": "SqlMi"
                    }
                  },
                  "required": [
                    "targetType"
                  ]
                }
              ]
            },
            {
              "allOf": [
                {
                  "$ref": "#/definitions/SqlVmTargetProperties"
                },
                {
                  "type": "object",
                  "properties": {
                    "targetType": {
                      "const": "SqlVm"
                    }
                  },
                  "required": [
                    "targetType"
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "TrackedResourceTags": {
      "type": "object",
      "properties": {},
      "additionalProperties": {
        "type": "string"
      }
    },
    "UserAssignedIdentities": {
      "type": "object",
      "properties": {},
      "additionalProperties": {
        "$ref": "#/definitions/UserAssignedIdentity"
      }
    },
    "UserAssignedIdentity": {
      "type": "object",
      "properties": {}
    },
    "VaultSecret": {
      "type": "object",
      "properties": {
        "akvResourceId": {
          "type": "string",
          "description": "The Azure resource ID of the Key Vault instance storing database authentication secrets."
        },
        "akvTargetPassword": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-zA-Z0-9-]{1,127}$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The path to the Key Vault secret storing the password for authentication to a target."
        },
        "akvTargetUser": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-zA-Z0-9-]{1,127}$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The path to the Key Vault secret storing the login name (aka user name, aka account name) for authentication to a target."
        }
      }
    },
    "WatcherProperties": {
      "type": "object",
      "properties": {
        "datastore": {
          "oneOf": [
            {
              "$ref": "#/definitions/Datastore"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The data store for collected monitoring data."
        },
        "defaultAlertRuleIdentityResourceId": {
          "type": "string",
          "description": "The resource ID of a user-assigned managed identity that will be assigned to a new alert rule."
        }
      }
    },
    "watchers_alertRuleResources_childResource": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-10-01-preview"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-zA-Z0-9]{1}[a-zA-Z0-9-_.]{0,62}[a-zA-Z0-9_]{1}$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "alertRuleResources"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/AlertRuleResourceProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource-specific properties for this resource."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.DatabaseWatcher/watchers/alertRuleResources"
    },
    "watchers_healthValidations_childResource": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-10-01-preview"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-zA-Z0-9]{1}[a-zA-Z0-9-_.]{0,62}[a-zA-Z0-9_]{1}$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "healthValidations"
          ]
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type"
      ],
      "description": "Microsoft.DatabaseWatcher/watchers/healthValidations"
    },
    "watchers_sharedPrivateLinkResources_childResource": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-10-01-preview"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-zA-Z0-9]{1}[a-zA-Z0-9-_.]{0,62}[a-zA-Z0-9_]{1}$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "sharedPrivateLinkResources"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/SharedPrivateLinkResourceProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource-specific properties for this resource."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.DatabaseWatcher/watchers/sharedPrivateLinkResources"
    },
    "watchers_targets_childResource": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2024-10-01-preview"
          ]
        },
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-zA-Z0-9]{1}[a-zA-Z0-9-_]{3,60}$"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource name"
        },
        "type": {
          "type": "string",
          "enum": [
            "targets"
          ]
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/TargetProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The resource-specific properties for this resource."
        }
      },
      "required": [
        "name",
        "apiVersion",
        "type",
        "properties"
      ],
      "description": "Microsoft.DatabaseWatcher/watchers/targets"
    }
  }
}