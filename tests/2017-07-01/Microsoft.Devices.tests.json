{
  "tests": [
    {
      "name": "IotHubs - full",
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub1",
        "type": "Microsoft.Devices/IotHubs",
        "apiVersion": "2017-07-01",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 1
        },
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "ipFilterRules": [
            {
              "filterName": "testIpFilterRule",
              "action": "Accept",
              "ipMask": "0.0.0.0/0"
            }
          ],
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 2,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 20
            }
          },
          "features": "DeviceManagement"
        }
      }
    },
    {
      "name": "IotHubs - Out of range test for cloudToDevice > maxDeliverCount",
      "expectedErrors": [
        {
          "message": "Data does not match any schemas from \"oneOf\"",
          "dataPath": "/properties",
          "schemaPath": "/properties/properties/oneOf",
          "subErrors": [
            {
              "message": "Data does not match any schemas from \"oneOf\"",
              "dataPath": "/properties/cloudToDevice",
              "schemaPath": "/properties/properties/oneOf/0/properties/cloudToDevice/oneOf",
              "subErrors": [
                {
                  "message": "Data does not match any schemas from \"oneOf\"",
                  "dataPath": "/properties/cloudToDevice/maxDeliveryCount",
                  "schemaPath": "/properties/properties/oneOf/0/properties/cloudToDevice/oneOf/0/properties/maxDeliveryCount/oneOf",
                  "subErrors": [
                    {
                      "message": "Value 300 is greater than maximum 100",
                      "dataPath": "/properties/cloudToDevice/maxDeliveryCount",
                      "schemaPath": "/properties/properties/oneOf/0/properties/cloudToDevice/oneOf/0/properties/maxDeliveryCount/oneOf/0/maximum"
                    },
                    {
                      "message": "Invalid type: number (expected string)",
                      "dataPath": "/properties/cloudToDevice/maxDeliveryCount",
                      "schemaPath": "/properties/properties/oneOf/0/properties/cloudToDevice/oneOf/0/properties/maxDeliveryCount/oneOf/1/type"
                    }
                  ]
                },
                {
                  "message": "Invalid type: object (expected string)",
                  "dataPath": "/properties/cloudToDevice",
                  "schemaPath": "/properties/properties/oneOf/0/properties/cloudToDevice/oneOf/1/type"
                }
              ]
            },
            {
              "message": "Invalid type: object (expected string)",
              "dataPath": "/properties",
              "schemaPath": "/properties/properties/oneOf/1/type"
            }
          ]
        }
      ],
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub1",
        "type": "Microsoft.Devices/IotHubs",
        "apiVersion": "2017-07-01",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 100
        },
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 300,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 20
            }
          },
          "features": "DeviceManagement"
        }
      }
    },
    {
      "name": "IotHubs - Out of range test for cloudToDevice > feedback > maxDeliverCount",
      "expectedErrors": [
        {
          "message": "Data does not match any schemas from \"oneOf\"",
          "dataPath": "/properties",
          "schemaPath": "/properties/properties/oneOf",
          "subErrors": [
            {
              "message": "Data does not match any schemas from \"oneOf\"",
              "dataPath": "/properties/cloudToDevice",
              "schemaPath": "/properties/properties/oneOf/0/properties/cloudToDevice/oneOf",
              "subErrors": [
                {
                  "message": "Data does not match any schemas from \"oneOf\"",
                  "dataPath": "/properties/cloudToDevice/feedback",
                  "schemaPath": "/properties/properties/oneOf/0/properties/cloudToDevice/oneOf/0/properties/feedback/oneOf",
                  "subErrors": [
                    {
                      "message": "Data does not match any schemas from \"oneOf\"",
                      "dataPath": "/properties/cloudToDevice/feedback/maxDeliveryCount",
                      "schemaPath": "/properties/properties/oneOf/0/properties/cloudToDevice/oneOf/0/properties/feedback/oneOf/0/properties/maxDeliveryCount/oneOf",
                      "subErrors": [
                        {
                          "message": "Value 300 is greater than maximum 100",
                          "dataPath": "/properties/cloudToDevice/feedback/maxDeliveryCount",
                          "schemaPath": "/properties/properties/oneOf/0/properties/cloudToDevice/oneOf/0/properties/feedback/oneOf/0/properties/maxDeliveryCount/oneOf/0/maximum"
                        },
                        {
                          "message": "Invalid type: number (expected string)",
                          "dataPath": "/properties/cloudToDevice/feedback/maxDeliveryCount",
                          "schemaPath": "/properties/properties/oneOf/0/properties/cloudToDevice/oneOf/0/properties/feedback/oneOf/0/properties/maxDeliveryCount/oneOf/1/type"
                        }
                      ]
                    },
                    {
                      "message": "Invalid type: object (expected string)",
                      "dataPath": "/properties/cloudToDevice/feedback",
                      "schemaPath": "/properties/properties/oneOf/0/properties/cloudToDevice/oneOf/0/properties/feedback/oneOf/1/type"
                    }
                  ]
                },
                {
                  "message": "Invalid type: object (expected string)",
                  "dataPath": "/properties/cloudToDevice",
                  "schemaPath": "/properties/properties/oneOf/0/properties/cloudToDevice/oneOf/1/type"
                }
              ]
            },
            {
              "message": "Invalid type: object (expected string)",
              "dataPath": "/properties",
              "schemaPath": "/properties/properties/oneOf/1/type"
            }
          ]
        }
      ],
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub1",
        "type": "Microsoft.Devices/IotHubs",
        "apiVersion": "2017-07-01",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 100
        },
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 30,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 300
            }
          },
          "features": "DeviceManagement"
        }
      }
    },
    {
      "name": "IotHubs - Missing required apiVersion property",
      "expectedErrors": [
        {
          "message": "Missing required property: apiVersion",
          "dataPath": "/",
          "schemaPath": "/required/2"
        }
      ],
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub1",
        "type": "Microsoft.Devices/IotHubs",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 1
        },
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 100,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 20
            }
          },
          "features": "DeviceManagement"
        }
      }
    },
    {
      "name": "IotHubs - Missing required type property",
      "expectedErrors": [
        {
          "message": "Missing required property: type",
          "dataPath": "/",
          "schemaPath": "/required/2"
        }
      ],
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub1",
        "apiVersion": "2017-07-01",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 1
        },
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 100,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 20
            }
          },
          "features": "DeviceManagement"
        }
      }
    },
    {
      "name": "IotHubs - Missing required name property",
      "expectedErrors": [
        {
          "message": "Missing required property: name",
          "dataPath": "/",
          "schemaPath": "/required/2"
        }
      ],
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "type": "Microsoft.Devices/IotHubs",
        "apiVersion": "2017-07-01",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 1
        },
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 100,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 20
            }
          },
          "features": "DeviceManagement"
        }
      }
    },
    {
      "name": "IotHubs - Missing required location property",
      "expectedErrors": [
        {
          "message": "Missing required property: location",
          "dataPath": "/",
          "schemaPath": "/required/2"
        }
      ],
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub1",
        "type": "Microsoft.Devices/IotHubs",
        "apiVersion": "2017-07-01",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 1
        },
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 100,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 20
            }
          },
          "features": "DeviceManagement"
        }
      }
    },
    {
      "name": "IotHubs - Missing required sku property",
      "expectedErrors": [
        {
          "message": "Missing required property: sku",
          "dataPath": "/",
          "schemaPath": "/required/2"
        }
      ],
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub1",
        "type": "Microsoft.Devices/IotHubs",
        "apiVersion": "2017-07-01",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 100,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 20
            }
          },
          "features": "DeviceManagement"
        }
      }
    },
    {
      "name": "IotHubs - Missing required properties property",
      "expectedErrors": [
        {
          "message": "Missing required property: properties",
          "dataPath": "/",
          "schemaPath": "/required/2"
        }
      ],
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub1",
        "type": "Microsoft.Devices/IotHubs",
        "apiVersion": "2017-07-01",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 1
        }
      }
    },
    {
      "name": "IotHubs - Invalid apiVersion value",
      "expectedErrors": [
        {
          "message": "No enum match for: \"2016-02-04\"",
          "dataPath": "/apiVersion",
          "schemaPath": "/required/2"
        }
      ],
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub1",
        "type": "Microsoft.Devices/IotHubs",
        "apiVersion": "2016-02-04",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 1
        },
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 100,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 20
            }
          },
          "features": "DeviceManagement"
        }
      }
    },
    {
      "name": "IotHubs - Invalid type value",
      "expectedErrors": [
        {
          "message": "No enum match for: \"Microsoft.Devices/IotHub\"",
          "dataPath": "/type",
          "schemaPath": "/required/2"
        }
      ],
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub1",
        "type": "Microsoft.Devices/IotHub",
        "apiVersion": "2017-07-01",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 1
        },
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 100,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 20
            }
          },
          "features": "DeviceManagement"
        }
      }
    },
    {
      "name": "IotHubs - Valid name - Hyphens in between and numbers",
      "expectedErrors": [
      ],
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub12-34",
        "type": "Microsoft.Devices/IotHubs",
        "apiVersion": "2017-07-01",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 1
        },
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 100,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 20
            }
          },
          "features": "DeviceManagement"
        }
      }
    },
    {
      "name": "IotHubs - Valid multiple enums for rights",
      "expectedErrors": [
      ],
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub12-34",
        "type": "Microsoft.Devices/IotHubs",
        "apiVersion": "2017-07-01",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 1
        },
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite, ServiceConnect"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 100,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 20
            }
          },
          "features": "DeviceManagement"
        }
      }
    },
    {
      "name": "IotHubs - Invalid enum for rights",
      "expectedErrors": [
        {
          "message": "Data does not match any schemas from \"oneOf\"",
          "dataPath": "/properties",
          "schemaPath": "/properties/properties/oneOf",
          "subErrors": [
            {
              "message": "Data does not match any schemas from \"oneOf\"",
              "dataPath": "/properties/authorizationPolicies",
              "schemaPath": "/properties/properties/oneOf/0/properties/authorizationPolicies/oneOf",
              "subErrors": [
                {
                  "message": "No enum match for: \"RegistryWrite, ServiceConnec\"",
                  "dataPath": "/properties/authorizationPolicies/0/rights",
                  "schemaPath": "/properties/properties/oneOf/0/properties/authorizationPolicies/oneOf/0/items/properties/rights/type"
                },
                {
                  "message": "Invalid type: array (expected string)",
                  "dataPath": "/properties/authorizationPolicies",
                  "schemaPath": "/properties/properties/oneOf/0/properties/authorizationPolicies/oneOf/1/type"
                }
              ]
            },
            {
              "message": "Invalid type: object (expected string)",
              "dataPath": "/properties",
              "schemaPath": "/properties/properties/oneOf/1/type"
            }
          ]
        }
      ],
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub12-34",
        "type": "Microsoft.Devices/IotHubs",
        "apiVersion": "2017-07-01",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 1
        },
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite, ServiceConnec"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 100,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 20
            }
          },
          "features": "DeviceManagement"
        }
      }
    },
    {
      "name": "IotHubs - Invalid enum for Ip filter action",
      "expectedErrors": [
        {
          "message": "Data does not match any schemas from \"oneOf\"",
          "dataPath": "/properties",
          "schemaPath": "/properties/properties/oneOf",
          "subErrors": [
            {
              "message": "Data does not match any schemas from \"oneOf\"",
              "dataPath": "/properties/ipFilterRules",
              "schemaPath": "/properties/properties/oneOf/0/properties/ipFilterRules/oneOf",
              "subErrors": [
                {
                  "message": "No enum match for: \"Accet\"",
                  "dataPath": "/properties/ipFilterRules/0/action",
                  "schemaPath": "/properties/properties/oneOf/0/properties/ipFilterRules/oneOf/0/items/properties/rights/type"
                },
                {
                  "message": "Invalid type: array (expected string)",
                  "dataPath": "/properties/ipFilterRules",
                  "schemaPath": "/properties/properties/oneOf/0/properties/ipFilterRules/oneOf/1/type"
                }
              ]
            },
            {
              "message": "Invalid type: object (expected string)",
              "dataPath": "/properties",
              "schemaPath": "/properties/properties/oneOf/1/type"
            }
          ]
        }
      ],
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub12-34",
        "type": "Microsoft.Devices/IotHubs",
        "apiVersion": "2017-07-01",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 1
        },
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite, ServiceConnect"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "ipFilterRules": [
            {
              "filterName": "testIpFilterRule",
              "action": "Accet",
              "ipMask": "0.0.0.0/0"
            }
          ],
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 100,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 20
            }
          },
          "features": "DeviceManagement"
        }
      }
    },
    {
      "name": "IotHubs - Missing required Ip filter rule property",
      "expectedErrors": [
        {
          "message": "Data does not match any schemas from \"oneOf\"",
          "dataPath": "/properties",
          "schemaPath": "/properties/properties/oneOf",
          "subErrors": [
            {
              "message": "Data does not match any schemas from \"oneOf\"",
              "dataPath": "/properties/ipFilterRules",
              "schemaPath": "/properties/properties/oneOf/0/properties/ipFilterRules/oneOf",
              "subErrors": [
                {
                  "message": "Missing required property: ipMask",
                  "dataPath": "/properties/ipFilterRules/0",
                  "schemaPath": "/properties/properties/oneOf/0/properties/ipFilterRules/oneOf/0/items/required/2"
                },
                {
                  "message": "Invalid type: array (expected string)",
                  "dataPath": "/properties/ipFilterRules",
                  "schemaPath": "/properties/properties/oneOf/0/properties/ipFilterRules/oneOf/1/type"
                }
              ]
            },
            {
              "message": "Invalid type: object (expected string)",
              "dataPath": "/properties",
              "schemaPath": "/properties/properties/oneOf/1/type"
            }
          ]
        }
      ],
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub12-34",
        "type": "Microsoft.Devices/IotHubs",
        "apiVersion": "2017-07-01",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 1
        },
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite, ServiceConnect"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "ipFilterRules": [
            {
              "filterName": "ipFilterRule",
              "action": "Accept"
            }
          ],
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 100,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 20
            }
          },
          "features": "DeviceManagement"
        }
      }
    },
	  {
      "name": "IotHubs - RoutingProperty",
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub12-34",
        "type": "Microsoft.Devices/IotHubs",
        "apiVersion": "2017-07-01",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 1
        },
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite, ServiceConnect"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "routing": {
            "endpoints": {
                "eventHubs": [
                  {
                    "name":"myeventEH",
                    "connectionString": "<myconnectionString>"                    
                  },
                  {
                    "name":"myname1",
                    "connectionString": "<myconnectionString1>"                    
                  }
                ],
                "serviceBusQueues": [
                  {
                    "name":"myQueue",
                    "connectionString": "<myconnectionString>"                    
                  }
                ]
            },
            "routes": [
              {
                "name": "rule1",
                "source": "DeviceMessages",
                "endpointNames":["myeventEH"],
                "condition": "some condition",
                "isEnabled":true
              }
            ],
            "fallbackRoute": {
                "name": "rule2",
                "source": "DeviceMessages",
                "endpointNames":["myQueue"],
                "condition": "some condition",
                "isEnabled":true
            }
          },
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 100,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 20
            }
          },
          "features": "DeviceManagement"
        }
      }  
    },
    {  
      "name": "IotHubs - RoutingProperty without RuleName",
      "expectedErrors":[
        {
          "message": "Data does not match any schemas from \"oneOf\"",
          "dataPath": "/properties",
          "schemaPath": "/properties/properties/oneOf",
          "subErrors":[
            {
              "message": "Data does not match any schemas from \"oneOf\"",
              "dataPath": "/properties/routing/rules/routes",
              "schemaPath": "/properties/properties/oneOf/0/properties/routing/properties/rules/properties/routes/oneOf",
              "subErrors": [
                {
                  "message": "Missing required property: name",
                  "dataPath": "/properties/routing/rules/routes/0",
                  "schemaPath": "/properties/properties/oneOf/0/properties/routing/properties/rules/properties/routes/oneOf/0/items/required/0"
                },
                {
                  "message": "Invalid type: array (expected string)",
                  "dataPath": "/properties/routing/rules/routes",
                  "schemaPath": "/properties/properties/oneOf/0/properties/routing/properties/rules/properties/routes/oneOf/1/type"
                }
              ]
            },
            {
              "message": "Invalid type: object (expected string)",
              "dataPath": "/properties",
              "schemaPath": "/properties/properties/oneOf/1/type"
            }
          ]
        }
      ],
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub12-34",
        "type": "Microsoft.Devices/IotHubs",
        "apiVersion": "2017-07-01",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 1
        },
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite, ServiceConnect"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "routing": {
            "endpoints": {
                "eventHubs": [
                  {
                    "name":"myeventEH",
                    "connectionString": "<myconnectionString>"
                  }
                ],
                "serviceBusQueues": [
                  {
                    "name":"myQueue",
                    "connectionString": "<myconnectionString>"
                  }
                ]
            },
            "routes": [
              {
                "source": "DeviceMessages",
                "endpointNames":["myeventEH"],
                "condition": "some condition",
                "isEnabled":true
              }
            ],
            "fallbackRoute": {
                "name": "rule2",
                "source": "DeviceMessages",
                "endpointNames":["myQueue"],
                "isEnabled":true
            }
          },
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 100,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 20
            }
          },
          "features": "DeviceManagement"
        }
      }
    },
    {
      "name": "IotHubs - RoutingProperty without EndpointNames",
      "expectedErrors":[
        {
          "message": "Data does not match any schemas from \"oneOf\"",
          "dataPath": "/properties",
          "schemaPath": "/properties/properties/oneOf",
          "subErrors": [
            {
              "message": "Data does not match any schemas from \"oneOf\"",
              "dataPath": "/properties/routing/rules/routes",
              "schemaPath": "/properties/properties/oneOf/0/properties/routing/properties/rules/properties/routes/oneOf",
              "subErrors": [
                {
                  "message": "Missing required property: endpointName",
                  "dataPath": "/properties/routing/rules/routes/0",
                  "schemaPath": "/properties/properties/oneOf/0/properties/routing/properties/rules/properties/routes/oneOf/0/items/required/0"
                },
                {
                  "message": "Invalid type: array (expected string)",
                  "dataPath": "/properties/routing/rules/routes",
                  "schemaPath": "/properties/properties/oneOf/0/properties/routing/properties/rules/properties/routes/oneOf/1/type"
                }
              ]
            },
            {
              "message": "Invalid type: object (expected string)",
              "dataPath": "/properties",
              "schemaPath": "/properties/properties/oneOf/1/type"
            }
          ]
        }
      ],
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub12-34",
        "type": "Microsoft.Devices/IotHubs",
        "apiVersion": "2017-07-01",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 1
        },
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite, ServiceConnect"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "routing": {
            "endpoints": {
              "eventHubs": [
                {
                  "name":"myeventEH",
                  "connectionString": "<myconnectionString>"
                }
              ],
              "serviceBusQueues": [
                {
                  "name":"myQueue",
                  "connectionString": "<myconnectionString>"
                }
              ]
            },
            "routes": [
              {
                "name":"rule1",
                "source": "DeviceMessages",
                "condition": "some condition",
                "isEnabled":true
              }
            ],
            "fallbackRoute": {
              "name": "rule2",
              "source": "DeviceMessages",
              "endpointName":"myQueue",
              "isEnabled":true
            }
          },
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 100,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 20
            }
          },
          "features": "DeviceManagement"
        }
      }
    },
    {
      "name": "IotHubs - RoutingProperty with Id",
      "definition": "https://schema.management.azure.com/schemas/2017-07-01/Microsoft.Devices.json#/resourceDefinitions/IotHubs",
      "json": {
        "name": "hub12-34",
        "type": "Microsoft.Devices/IotHubs",
        "apiVersion": "2017-07-01",
        "location": "West US",
        "subscriptionid": "mySuscriptionId",
        "resourcegroup": "myRg",
        "sku": {
          "name": "F1",
          "capacity": 1
        },
        "properties": {
          "authorizationPolicies": [
            {
              "keyName": "IotHubAllAccessSasKey",
              "primaryKey": "CQN2K33r45/0WeIjpqmErV5EIvX8JZrozt3NEHCEkG8=",
              "secondaryKey": "RpkT42rNZl4/J08pI8tnsE2mPbsbuQ//+9x3HSs0XcU=",
              "rights": "RegistryWrite, ServiceConnect"
            }
          ],
          "eventHubEndpoints": {
            "events": {
              "retentionTimeInDays": 2,
              "partitionCount": 2
            }
          },
          "storageEndpoints": {
            "fileUploadEndpoint": {
              "sasTtlAsIso8601": "PT1H",
              "connectionString": "AAAAABAAu3eNkJ1GCwvVE6R87dIugyAAFxdSay61We3kBRSLZ/hgRoN37m87pjKd0UWhcZeibPvQADy9fyaS7xOMG655Xs6oU0sfIJcmfIfBKEueMpnzmoF4AV9S0YKXKSKB0kA2/rg4ds2IEbjzvq2ut8phMD+O0JQRwAB1MaU73NF8WVfpvWAsrhrgXTet8Xzdm7+p9p5w2YfFgz/Hiq4kLeSI2XH+SCIE341Atm/pR5VimTuEvngnmkq+2P2d+Svn5fgS9Xx16KDKHYqbg4bE2ea9gkSt0kAHimeeAUtwZt/oey1bDo9L2uzi58YFIeawYgo7YDLoyv4nah+MBqsfkYUISv02lLM=",
              "containerName": "fileuploadContainer"
            }
          },
          "routing": {
            "endpoints": {
              "eventHubs": [
                {
                  "name":"myeventEH",
                  "connectionString": "<myconnectionString>"
                }
              ],
              "serviceBusQueues": [
                {
                  "name":"myQueue",
                  "id":"123434234",
                  "connectionString": "<myconnectionString>"
                }
              ]
            },
            "routes": [
              {
                "name":"rule1",
                "endpointNames":["myeventEH"],
                "source": "DeviceMessages",
                "condition": "some condition",
                "isEnabled":true
              }
            ]
          },
          "enableFileUploadNotifications": true,
          "cloudToDevice": {
            "maxDeliveryCount": 100,
            "defaultTtlAsIso8601": "PT1H",
            "feedback": {
              "lockDurationAsIso8601": "PT1M",
              "ttlAsIso8601": "PT1H",
              "maxDeliveryCount": 20
            }
          },
          "features": "DeviceManagement"
        }
      }
    }
  ]
}
